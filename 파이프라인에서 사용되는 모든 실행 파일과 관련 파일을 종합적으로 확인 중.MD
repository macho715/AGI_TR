파이프라인에서 사용되는 모든 실행 파일과 관련 파일을 종합적으로 확인 중.


[6 tools called]


파이프라인에서 참조하는 모든 파일을 종합적으로 확인 중.


[6 tools called]


파이프라인에서 사용되는 모든 실행 파일과 관련 파일을 종합 정리 중.


[5 tools called]


## 파이프라인 실행 파일 및 관련 파일 종합 보고서

### 1. 메인 파이프라인 오케스트레이터

| 파일명 | 경로 | 역할 | 실행 방식 |
|--------|------|------|----------|
| **integrated_pipeline_defsplit_v2_gate270_split_v3_auditpatched_autodetect_TIDE_v1.py** | `01_EXECUTION_FILES/tide/` | 메인 파이프라인 오케스트레이터 (7,145 lines) | 직접 실행 (`python`) |

---

### 2. 필수 실행 파일 (Main Pipeline Steps)

| Step | 스크립트 파일명 | 기본 경로 | 실행 방식 | 설명 |
|------|---------------|---------|----------|------|
| **Step 0** | `agi_spmt_unified.py` | `spmt v1/agi_spmt_unified.py` | `subprocess` | SPMT cargo 입력 생성 (선택적) |
| **Step 1** | `agi_tr_patched_v6_6_defsplit_v1.py` | `01_EXECUTION_FILES/` | `subprocess` | TR Excel 생성 (선택적) |
| **Step 1b** | (내장) | (내장) | (내장 함수) | `stage_results.csv` 생성 (TR 스크립트 또는 내장) |
| **Step 2** | `ops_final_r3_integrated_defs_split_v4_patched_TIDE_v1.py` | `01_EXECUTION_FILES/tide/` | `subprocess` | OPS Integrated 리포트 (Excel + MD) |
| **Step 3** | `ballast_gate_solver_v4_TIDE_v1.py` | `01_EXECUTION_FILES/tide/` | `subprocess` | LP Solver (Gate 기반 ballast 최적화) |
| **Step 4** | `Untitled-2_patched_defsplit_v1_1.py` | `01_EXECUTION_FILES/` | `subprocess` | Optimizer (Heuristic 최적화) |
| **Step 4b** | `ballast_sequence_generator.py` | `01_EXECUTION_FILES/` | `subprocess` | Ballast Sequence 생성 (선택적, `--enable-sequence`) |
| **Step 4b** | `checklist_generator.py` | `01_EXECUTION_FILES/` | `subprocess` | Checklist 생성 (선택적, `--enable-sequence`) |
| **Step 4c** | `valve_lineup_generator.py` | `01_EXECUTION_FILES/` | `import` 모듈 | Valve Lineup 생성 (선택적, `--enable-valve-lineup`) |
| **Step 5** | `bryan_template_unified_TIDE_v1.py` | `01_EXECUTION_FILES/tide/` | `subprocess` | Bryan Template 생성 |

---

### 3. 선택적 실행 파일 (Post-Processing)

| 파일명 | 경로 | 실행 조건 | 역할 |
|--------|------|----------|------|
| `excel_com_recalc_save.py` | `01_EXECUTION_FILES/tide/` | `EXCEL_COM_RECALC` 환경 변수 설정 시 | Excel 수식 재계산 (COM, Windows 전용) |
| `ballast_excel_finalize.py` | `01_EXECUTION_FILES/` | 파일 존재 시 자동 실행 | Excel 수식 최종화 |
| `debug_report.py` | `01_EXECUTION_FILES/` 또는 프로젝트 루트 | `--debug_report` 또는 `--auto_debug_report` | 디버그 리포트 생성 (선택적) |

---

### 4. 모듈 (Import되는 파일)

#### 4.1 SSOT 모듈 (`ssot/`)

| 파일명 | 경로 | 역할 |
|--------|------|------|
| `data_quality_validator.py` | `01_EXECUTION_FILES/ssot/` | 데이터 품질 검증 및 Tidying (783 lines) |
| `gates_loader.py` | `01_EXECUTION_FILES/ssot/` | SiteProfile 로딩 |
| `headers_registry.py` | `01_EXECUTION_FILES/ssot/` | Headers SSOT 관리 |
| `head_guard_v2.py` | `01_EXECUTION_FILES/ssot/` | Head Guard 검증 |
| `headers_writer.py` | `01_EXECUTION_FILES/ssot/` | Headers 작성 |
| `tidying_models.py` | `01_EXECUTION_FILES/ssot/` | Tidying 모델 정의 |
| `validators.py` | `01_EXECUTION_FILES/ssot/` | 검증기 |
| `draft_calc.py` | `01_EXECUTION_FILES/ssot/` | Draft 계산 |

#### 4.2 Tide/UKC 모듈 (`tide/`)

| 파일명 | 경로 | 역할 |
|--------|------|------|
| `tide_ukc_engine.py` | `01_EXECUTION_FILES/tide/` | Tide/UKC 계산 엔진 |
| `tide_constants.py` | `01_EXECUTION_FILES/tide/` | Tide 상수 정의 |

#### 4.3 SPMT 모듈 (`spmt v1/`)

| 파일명 | 경로 | 역할 |
|--------|------|------|
| `agi_ssot.py` | `01_EXECUTION_FILES/spmt v1/` | SPMT SSOT 처리 |
| `lct_stage_spmt_shuttle_AGI_SSOT_patched.py` | `01_EXECUTION_FILES/spmt v1/` | LCT Stage SPMT Shuttle |
| `spmt2_AGI_SSOT_patched.py` | `01_EXECUTION_FILES/spmt v1/` | SPMT2 처리 |

---

### 5. 유틸리티 스크립트 (동적 Import/실행)

| 파일명 | 경로 | 실행 방식 | 역할 |
|--------|------|----------|------|
| `compile_headers_registry.py` | `01_EXECUTION_FILES/` | 동적 `__import__` | `HEADERS_MASTER.xlsx` → `headers_registry.json` 컴파일 |
| `tide_stage_mapper.py` | `01_EXECUTION_FILES/` | (참조만) | Tide stage 매핑 |

---

### 6. 입력 데이터 파일

#### 6.1 필수 입력 파일

| 파일명 | 경로 | 용도 | 필수 여부 |
|--------|------|------|----------|
| `tank_catalog_from_tankmd.json` | `02_RAW_DATA/` 또는 `inputs_dir/` | Tank 카탈로그 | 필수 |
| `Hydro_Table_Engineering.json` | `01_EXECUTION_FILES/bplus_inputs/` 또는 `02_RAW_DATA/bplus_inputs/` | Hydrostatic 테이블 | 필수 |
| `Frame_x_from_mid_m.json` | `01_EXECUTION_FILES/bplus_inputs/data/` 또는 `02_RAW_DATA/` | Frame ↔ x 변환 | 필수 |
| Site Profile JSON | `01_EXECUTION_FILES/bplus_inputs/profiles/` 또는 `02_RAW_DATA/profiles/` | Site profile (자동 탐색) | 필수 |

#### 6.2 선택적 입력 파일

| 파일명 | 경로 | 용도 | 필수 여부 |
|--------|------|------|----------|
| `stage_results.csv` | `02_RAW_DATA/` 또는 Step-1b 출력 | Stage 결과 | 선택적 (생성 가능) |
| `current_t_sensor.csv` | `02_RAW_DATA/sensors/` 또는 `01_EXECUTION_FILES/sensors/` | Current_t 센서 데이터 (자동 탐색) | 선택적 |
| `stage_schedule.csv` | `01_EXECUTION_FILES/bplus_inputs/` | Stage별 타임스탬프 (tide 보간용) | 선택적 |
| `water tide_202512.xlsx` | `01_EXECUTION_FILES/bplus_inputs/` | Tide 데이터 (Excel) | 선택적 |
| `tide_windows_AGI.json` | `01_EXECUTION_FILES/bplus_inputs/` | Stage별 tide window 정의 | 선택적 |
| `LCT_BUSHRA_GM_2D_Grid.json` | `01_EXECUTION_FILES/bplus_inputs/` 또는 `02_RAW_DATA/` | GM 2D Grid (GM 검증) | 선택적 |
| `Tank_FSM_Coeff.json` | `01_EXECUTION_FILES/bplus_inputs/` | FSM 계수 (GM 검증) | 선택적 |
| `Acceptance_Criteria.json` | `01_EXECUTION_FILES/bplus_inputs/` 또는 `02_RAW_DATA/additional_inputs/` | 승인 기준 | 선택적 |
| `GM_Min_Curve.json` | `01_EXECUTION_FILES/bplus_inputs/` 또는 `02_RAW_DATA/additional_inputs/` | GM 최소 곡선 | 선택적 |
| `ISCODE_Criteria.json` | `01_EXECUTION_FILES/bplus_inputs/` 또는 `02_RAW_DATA/additional_inputs/` | ISCODE 기준 | 선택적 |
| `Securing_Input.json` | `01_EXECUTION_FILES/bplus_inputs/` 또는 `02_RAW_DATA/additional_inputs/` | 고정 입력 | 선택적 |
| `Structural_Limits.json` | `01_EXECUTION_FILES/bplus_inputs/` 또는 `02_RAW_DATA/additional_inputs/` | 구조적 제한 | 선택적 |

---

### 7. 설정 파일

| 파일명 | 경로 | 용도 |
|--------|------|------|
| `valve_map.json` | `01_EXECUTION_FILES/` | Valve 매핑 (Step 4c용) |
| `headers_registry.json` | `01_EXECUTION_FILES/` | Headers SSOT 레지스트리 (자동 컴파일 가능) |
| `HEADERS_MASTER.xlsx` | `01_EXECUTION_FILES/` | Headers SSOT 마스터 (Excel, 사람 편집용) |
| `requirements.txt` | `01_EXECUTION_FILES/` 또는 `01_EXECUTION_FILES/tide/` | Python 의존성 |
| `spmt_shuttle_example_config_AGI_FR_M.json` | `01_EXECUTION_FILES/spmt v1/` | SPMT 설정 예시 |

---

### 8. 출력 파일 (생성되는 파일)

#### 8.1 SSOT 출력 파일

| 파일명 | 경로 | 생성 Step | 설명 |
|--------|------|----------|------|
| `tank_ssot_for_solver.csv` | `out_dir/ssot/` | Step-2 | Tank SSOT (Solver용) |
| `hydro_ssot_for_solver.csv` | `out_dir/ssot/` | Step-2 | Hydro SSOT (Solver용) |
| `stage_table_unified.csv` | `out_dir/ssot/` | Step-2 | Stage 테이블 (통합) |
| `diff_audit.csv` | `out_dir/ssot/` | Step-2 | Current_t 센서 주입 감사 로그 |

#### 8.2 Solver 출력 파일

| 파일명 | 경로 | 생성 Step | 설명 |
|--------|------|----------|------|
| `solver_ballast_plan.csv` | `out_dir/` | Step-3 | Solver ballast plan |
| `solver_ballast_summary.csv` | `out_dir/` | Step-3 | Solver 요약 |
| `solver_ballast_stage_plan.csv` | `out_dir/` | Step-3 | Stage별 ballast plan |
| `solver_state_trace.csv` | `out_dir/` | Step-3 | State trace (stateful solver) |

#### 8.3 Sequence 출력 파일

| 파일명 | 경로 | 생성 Step | 설명 |
|--------|------|----------|------|
| `BALLAST_SEQUENCE.csv` | `out_dir/` | Step-4b | Ballast sequence (CSV) |
| `BALLAST_SEQUENCE.xlsx` | `out_dir/` | Step-4b | Ballast sequence (Excel) |
| `BALLAST_EXEC.csv` | `out_dir/` | Step-4b | Ballast execution plan |
| `BALLAST_OPTION.csv` | `out_dir/` | Step-4b | Ballast option plan |
| `BALLAST_SEQUENCE_WITH_VALVES.md` | `out_dir/` | Step-4c | Valve lineup 포함 sequence |
| `BALLAST_CHECKLIST.md` | `out_dir/` | Step-4b | Checklist |

#### 8.4 Excel 출력 파일

| 파일명 | 경로 | 생성 Step | 설명 |
|--------|------|----------|------|
| `LCT_BUSHRA_{SITE}_TR_Final_v*.xlsx` | `out_dir/` 또는 `base_dir/` | Step-1 | TR Excel |
| `OPS_FINAL_R3_{SITE}_Ballast_Integrated.xlsx` | `out_dir/` 또는 `base_dir/` | Step-2 | OPS Integrated Excel |
| `optimizer_ballast_plan.xlsx` | `out_dir/` | Step-4 | Optimizer Excel |
| `Bryan_Submission_Data_Pack_Populated.xlsx` | `out_dir/` | Step-5 | Bryan Template (Populated) |
| `Bryan_Submission_Data_Pack_Template_GENERATED.xlsx` | `out_dir/` | Step-5 | Bryan Template (Generated) |
| `PIPELINE_CONSOLIDATED_{SITE}_{TIMESTAMP}.xlsx` | `out_dir/` | Step-5 (후처리) | 통합 Excel (모든 시트 병합) |

#### 8.5 리포트 출력 파일

| 파일명 | 경로 | 생성 Step | 설명 |
|--------|------|----------|------|
| `OPS_FINAL_R3_Report_Integrated.md` | `out_dir/` 또는 `base_dir/` | Step-2 | OPS 리포트 (Markdown) |
| `pipeline_stage_QA.csv` | `out_dir/` | Step-2 | Stage QA |
| `gm_stability_verification_v2b.csv` | `out_dir/` | Step-5 (선택적) | GM 검증 결과 |
| `hold_point_analysis.csv` | `out_dir/` | Step-5 (선택적) | Hold point 분석 |

---

### 9. 실행 파일 통계

| 카테고리 | 개수 | 비고 |
|---------|------|------|
| **메인 오케스트레이터** | 1 | `integrated_pipeline_*.py` |
| **필수 실행 파일 (Step 0-5)** | 10 | Step별 스크립트 |
| **선택적 실행 파일 (Post-processing)** | 3 | Excel 재계산, 디버그 리포트 등 |
| **모듈 (Import)** | 11 | SSOT, Tide/UKC, SPMT 모듈 |
| **유틸리티 스크립트** | 2 | Headers registry 컴파일 등 |
| **총 실행 파일** | **27개** | (중복 제외) |

---

### 10. 파일 탐색 우선순위

#### 10.1 Site Profile 탐색 순서
1. `inputs_dir/bplus_inputs/profiles/{SITE}.json`
2. `inputs_dir/bplus_inputs/profiles/site_{SITE}.json`
3. `inputs_dir/bplus_inputs/site_profile_{SITE}.json`
4. `inputs_dir/profiles/{SITE}.json`
5. `inputs_dir/profiles/site_{SITE}.json`
6. `inputs_dir/site_profile_{SITE}.json`

#### 10.2 Current_t Sensor 탐색 순서
1. `inputs_dir/sensors/current_t_*.csv` (최신 mtime)
2. `inputs_dir/current_t_*.csv` (최신 mtime)
3. `base_dir/sensors/current_t_*.csv` (최신 mtime)
4. `base_dir/current_t_*.csv` (최신 mtime)

#### 10.3 Hydro Table 탐색 순서
1. `--hydro` 인자 (명시적 지정)
2. `inputs_dir/bplus_inputs/Hydro_Table_Engineering.json`
3. `base_dir/bplus_inputs/Hydro_Table_Engineering.json`
4. `02_RAW_DATA/bplus_inputs/Hydro_Table_Engineering.json`

---

### 11. 의존성 파일

| 파일명 | 경로 | 용도 |
|--------|------|------|
| `requirements.txt` | `01_EXECUTION_FILES/` 또는 `01_EXECUTION_FILES/tide/` | Python 패키지 의존성 |
| `__init__.py` | `01_EXECUTION_FILES/tide/`, `01_EXECUTION_FILES/ssot/` | Python 패키지 초기화 |

---

### 12. 테스트 파일 (참고)

| 파일명 | 경로 | 용도 |
|--------|------|------|
| `test_*.py` | `01_EXECUTION_FILES/spmt v1/tests/` | SPMT 테스트 |
| `verify_*.py` | `01_EXECUTION_FILES/` | 검증 스크립트 (다수) |

---

## 요약

- 총 실행 파일: 27개 (메인 오케스트레이터 1 + 필수 10 + 선택적 3 + 모듈 11 + 유틸리티 2)
- 총 입력 데이터 파일: 15개 이상 (필수 4 + 선택적 11+)
- 총 출력 파일: 20개 이상 (SSOT, Solver, Sequence, Excel, 리포트)
- 총 설정 파일: 5개 이상 (JSON, Excel, YAML 등)

파이프라인 코드를 재검토해 누락된 파일 확인 중.


[6 tools called]


추가 참조 파일 확인 중.


[6 tools called]


누락된 파일 확인 중.


[5 tools called]


누락된 파일 확인 중.


[5 tools called]


누락된 파일 확인 결과입니다.

## 누락된 파일 확인 결과

### 누락된 파일 (추가 필요)

#### 1. Step 5 관련 파일

| 파일명 | 경로 | 용도 | 현재 상태 |
|--------|------|------|----------|
| `create_bryan_excel_template_NEW.py` | `01_EXECUTION_FILES/` | Bryan Template 생성 (Step 5 내부) | 누락 |
| `populate_template.py` | `01_EXECUTION_FILES/` | Template 채움 로직 (Step 5 내부, 임베디드 가능) | 누락 |

#### 2. Post-Processing 파일

| 파일명 | 경로 | 용도 | 현재 상태 |
|--------|------|------|----------|
| `excel_com_recalc_save.py` | `01_EXECUTION_FILES/tide/` | Excel 수식 재계산 (COM, Windows 전용) | 누락 (코드에서 참조하지만 파일 없음) |

---

### 업데이트된 파일 목록

#### 2. 필수 실행 파일 (Main Pipeline Steps) - 업데이트

| Step | 스크립트 파일명 | 기본 경로 | 실행 방식 | 설명 |
|------|---------------|---------|----------|------|
| **Step 0** | `agi_spmt_unified.py` | `spmt v1/agi_spmt_unified.py` | `subprocess` | SPMT cargo 입력 생성 (선택적) |
| **Step 1** | `agi_tr_patched_v6_6_defsplit_v1.py` | `01_EXECUTION_FILES/` | `subprocess` | TR Excel 생성 (선택적) |
| **Step 1b** | (내장) | (내장) | (내장 함수) | `stage_results.csv` 생성 (TR 스크립트 또는 내장) |
| **Step 2** | `ops_final_r3_integrated_defs_split_v4_patched_TIDE_v1.py` | `01_EXECUTION_FILES/tide/` | `subprocess` | OPS Integrated 리포트 (Excel + MD) |
| **Step 3** | `ballast_gate_solver_v4_TIDE_v1.py` | `01_EXECUTION_FILES/tide/` | `subprocess` | LP Solver (Gate 기반 ballast 최적화) |
| **Step 4** | `Untitled-2_patched_defsplit_v1_1.py` | `01_EXECUTION_FILES/` | `subprocess` | Optimizer (Heuristic 최적화) |
| **Step 4b** | `ballast_sequence_generator.py` | `01_EXECUTION_FILES/` | `subprocess` / `import` | Ballast Sequence 생성 (선택적, `--enable-sequence`) |
| **Step 4b** | `checklist_generator.py` | `01_EXECUTION_FILES/` | `import` | Checklist 생성 (선택적, `--enable-sequence`) |
| **Step 4c** | `valve_lineup_generator.py` | `01_EXECUTION_FILES/` | `import` 모듈 | Valve Lineup 생성 (선택적, `--enable-valve-lineup`) |
| **Step 5** | `bryan_template_unified_TIDE_v1.py` | `01_EXECUTION_FILES/tide/` | `subprocess` | Bryan Template 생성 |
| **Step 5** (내부) | `create_bryan_excel_template_NEW.py` | `01_EXECUTION_FILES/` | `subprocess` (bryan_template_unified에서 호출) | Bryan Template Excel 생성 |
| **Step 5** (내부) | `populate_template.py` | `01_EXECUTION_FILES/` | `import` (임베디드 또는 별도) | Template 채움 로직 |

---

#### 3. 선택적 실행 파일 (Post-Processing) - 업데이트

| 파일명 | 경로 | 실행 조건 | 역할 |
|--------|------|----------|------|
| `excel_com_recalc_save.py` | `01_EXECUTION_FILES/tide/` | `EXCEL_COM_RECALC` 환경 변수 설정 시 | Excel 수식 재계산 (COM, Windows 전용) - 파일 존재 여부 불확실 |
| `ballast_excel_finalize.py` | `01_EXECUTION_FILES/` | 파일 존재 시 자동 실행 | Excel 수식 최종화 |
| `debug_report.py` | `01_EXECUTION_FILES/` 또는 프로젝트 루트 | `--debug_report` 또는 `--auto_debug_report` | 디버그 리포트 생성 (선택적) |

---

### 내장 함수로 생성되는 파일 (별도 스크립트 아님)

| 파일명 | 생성 위치 | 생성 함수 | 설명 |
|--------|----------|----------|------|
| `gate_fail_report.md` | `out_dir/` | `generate_gate_fail_report_md()` | Gate 실패 리포트 (내장 함수) |
| `TUG_Operational_SOP_DNV_ST_N001.md` | `out_dir/` | `generate_tug_operational_sop_md()` | TUG 운영 SOP (내장 함수) |
| `HOLD_POINT_SUMMARY.csv` | `out_dir/` | (Step 4b 내부) | Hold point 요약 (내장 로직) |

---

### 최종 통계 (업데이트)

| 카테고리 | 개수 | 비고 |
|---------|------|------|
| **메인 오케스트레이터** | 1 | `integrated_pipeline_*.py` |
| **필수 실행 파일 (Step 0-5)** | 12 | Step별 스크립트 + Step 5 내부 파일 2개 |
| **선택적 실행 파일 (Post-processing)** | 3 | Excel 재계산, 디버그 리포트 등 |
| **모듈 (Import)** | 11 | SSOT, Tide/UKC, SPMT 모듈 |
| **유틸리티 스크립트** | 2 | Headers registry 컴파일 등 |
| **총 실행 파일** | **29개** | (중복 제외, Step 5 내부 파일 포함) |

---

### 누락 확인 요약

- 누락된 파일: 3개
  1. `create_bryan_excel_template_NEW.py` (Step 5 내부)
  2. `populate_template.py` (Step 5 내부, 임베디드 가능)
  3. `excel_com_recalc_save.py` (Post-processing, 파일 존재 여부 불확실)

- 내장 함수로 생성되는 파일: 3개 (별도 스크립트 아님)
  - `gate_fail_report.md`
  - `TUG_Operational_SOP_DNV_ST_N001.md`
  - `HOLD_POINT_SUMMARY.csv`

문서에 위 3개 파일을 추가하세요.
