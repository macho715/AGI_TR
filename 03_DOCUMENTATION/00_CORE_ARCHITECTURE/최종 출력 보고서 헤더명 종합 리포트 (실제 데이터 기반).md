## 최종 출력 보고서 헤더명 종합 리포트 (전체 데이터 기반)

**출력 디렉토리**:
- `final_output_20251228_213110`
- `final_output_20251228_213759`
- `01_EXECUTION_FILES` (전체 디렉토리)

**생성일**: 2025-12-28
**최종 업데이트**: 2025-12-29
**버전**: 4.1 (전체 Excel 헤더 추출 데이터 기반 + 파이프라인 실행 파일 목록)
**데이터 소스**: `EXCEL_HEADERS_ALL_20251228_221902.md`
**추출 일시**: 2025-12-28 22:18:51
**파이프라인 실행 파일 검증일**: 2025-12-29
**검색 범위**: 전체 디렉토리 (재귀 검색, ARCHIVE 제외)
**파일 수**: 44개

---

## 목차

1. [CSV 파일 헤더](#1-csv-파일-헤더)
2. [Excel 파일 시트별 헤더 (전체 추출 데이터)](#2-excel-파일-시트별-헤더-전체-추출-데이터)
3. [Markdown 리포트 구조](#3-markdown-리포트-구조)
4. [헤더명 매핑 테이블](#4-헤더명-매핑-테이블)
5. [데이터 흐름 및 의존성](#5-데이터-흐름-및-의존성)
6. [통계 및 분석](#6-통계-및-분석)
7. [알려진 이슈 및 권고사항](#7-알려진-이슈-및-권고사항)
8. [버전별 차이 분석](#8-버전별-차이-분석)
9. [파이프라인 실행 파일 목록](#9-파이프라인-실행-파일-목록)

---

## 1. CSV 파일 헤더

[기존 내용 유지 - CSV 헤더는 변경 없음]

---

## 2. Excel 파일 시트별 헤더 (전체 추출 데이터)

### 2.0 파일 카테고리 개요

**총 파일 수**: 44개
**카테고리별 분류**:
- **Consolidated Excel**: 30+ 버전 (시간대별)
- **SPMT 관련**: 3개
- **Bryan Pack**: 4개 (Template, Populated, Extended, GENERATED)
- **OPS 리포트**: 2개
- **QA 리포트**: 1개
- **입력 파일**: 2개 (tide, Cargo)
- **기타**: 2개

---

### 2.1 QA 리포트

#### AGI_PIPELINE_CONSOLIDATED_FINAL_QA_20251227.xlsx
**경로**: `AGI_PIPELINE_CONSOLIDATED_FINAL_QA_20251227.xlsx`
**시트 수**: 1개

##### FINAL_QA
- **헤더 행**: 1
- **행/열**: 11 x 24
- **헤더**:
  1. `Stage`
  2. `Desc`
  3. `FWD_m`
  4. `AFT_m`
  5. `GateB_applicable`
  6. `GateB_FWD<=2.70`
  7. `Gate_FWD<=2.70(all?)`
  8. `FWD_Margin_m`
  9. `GateA_AFT>=2.70`
  10. `AFT_Margin_m`
  11. `Forecast_Tide_m`
  12. `Water_Level_m`
  13. `UKC_Min_m`
  14. `Gate_UKC`
  15. `Required_WL_m`
  16. `plan_rows`
  17. `Plan_TotalΔW_t`
  18. `Plan_TotalTime_h`
  19. `ΔW_t`
  20. `PumpTime_h`
  21. `New_FWD_m`
  22. `New_AFT_m`
  23. `viol_fwd_m`
  24. `QA_Notes`

---

### 2.2 입력 파일

#### water tide_202512.xlsx
**경로**: `bplus_inputs\water tide_202512.xlsx`
**시트 수**: 2개

##### December_Tide_2025
- **헤더 행**: None
- **행/열**: 745 x 2

##### Hourly_FWD_AFT_Heights
- **헤더 행**: 1
- **행/열**: 745 x 14
- **헤더**: TR Excel과 동일 (`DateTime (GST)`, `Tide_m`, `Dfwd_req_m (even)`, `Trim_m (optional)`, `Dfwd_adj_m`, `Daft_adj_m`, `Ramp_Angle_deg`, `Status`, `FWD_Height_m`, `AFT_Height_m`, `Notes`, `Trim_m (optional)` 중복)

#### Cargo_SPMT_Inputs_autofill.xlsx
**경로**: `Cargo_SPMT_Inputs_autofill.xlsx`
**시트 수**: 2개

##### Cargo_SPMT_Inputs
- **헤더 행**: None
- **행/열**: 11 x 10

##### Submission_Stagewise
- **헤더 행**: 3
- **행/열**: 22 x 8
- **헤더**:
  1. `Stage`
  2. `Total_t`
  3. `LCG_x_midship_m`
  4. `Note`
  (나머지 4개 컬럼 확인 필요)

---

### 2.3 Bryan 템플릿 확장 버전

#### Bryan_Request_Detail_Data_Template_AGI_ONLY_AllOptions_Extended.xlsx
**경로**: `Bryan_Request_Detail_Data_Template_AGI_ONLY_AllOptions_Extended.xlsx`
**시트 수**: 11개

**주요 시트**:
- `00_README` (헤더 없음, 27 x 8)
- `01_AGI_Config` (헤더 없음, 31 x 8)
- `01_GM2D_Grid` (헤더 없음, 11 x 8)
- `01_GM_Min_Curve` (헤더 없음, 55 x 2)
- `01_Hydro_AGI` (헤더 없음, 201 x 8)
- `02_Stage_AGI` (헤더 없음, 20 x 53)
- `03_Ballast_Op_Log` (헤더 행: 3, 203 x 14)
  - **헤더**: `Site`, `Stage`, `Operation_ID`, `Tank`, `Action(FILL/DISCHARGE/HOLD/VERIFY)`, `Start_Time`, `End_Time`, `Duration_h`, `Delta_t`, `Pump_Rate_tph`, `Expected_Time_h`, `Valve_Lineup_Ref`, `Operator`, `Remarks`
- `04_Tide_Weather_Log` (헤더 행: 3, 303 x 13)
  - **헤더**: `Site`, `Stage`, `DateTime`, `Forecast_Tide_m`, `Measured_Tide_m`, `Wave_Hs_m`, `Wind_mps`, `Current_kn`, `Visibility_km`, `Source(Official/Onsite)`, `Verified_By`, `Decision`, `Remarks`
- `05_Evidence_Log` (헤더 없음, 305 x 11)
- `06_Submission_Checklist` (헤더 행: 3, 20 x 7)
  - **헤더**: `Category`, `Item`, `AGI Required`, `DAS Required`, `Provided(Y/N)`, `File Ref`, `Remarks`
- `ZZ_Data_Dictionary` (헤더 행: 3, 14 x 8)
  - **헤더**: `Sheet`, `Field`, `Unit`, `Definition`, `Source`, `Owner`, `Mandatory`, `Notes`

#### Bryan_Submission_Data_Pack_Template_GENERATED.xlsx
**경로**: `Bryan_Submission_Data_Pack_Template_GENERATED.xlsx`
**시트 수**: 16개

**주요 시트** (헤더 있는 시트 11개):

##### 01_SSOT_Master
- **헤더 행**: 1
- **행/열**: 22 x 6
- **헤더**: `Control / Input`, `Value`, `Unit`, `Notes`, `Owner`, `Source/Ref`

##### 02_Vessel_Hydro
- **헤더 행**: 3
- **행/열**: 63 x 8
- **헤더**: `#`, `Disp_t`, `Tmean_m`, `TPC_t/cm`, `MTC_t·m/cm`, `LCF_m`, `GM_m`, `Source/Remark`

##### 03_Berth_Tide
- **헤더 행**: 3
- **행/열**: 133 x 5
- **헤더**: `Field`, `Value`, `Unit`, `Notes`, `Source`

##### 04_Cargo_SPMT
- **헤더 행**: 3
- **행/열**: 100 x 10
- **헤더**: `Item`, `Weight_t`, `CoG_x_m`, `CoG_y_m`, `CoG_z_m`, `Final_Frame`, `Ramp_Frame`, `L_m`, `W_m`, `Remarks/Source`

##### 05_Ballast_Tanks
- **헤더 행**: 1
- **행/열**: 207 x 13
- **헤더** (부분 확인): `Ballast Tank Catalog (input)`, `VENT_COEFF (t/h/mm)`, `0.86`

##### 06_Stage_Plan
- **헤더 행**: 1
- **행/열**: 201 x 8
- **헤더**: `Stage_ID`, `Progress_%`, `Planned_Start`, `Planned_End`, `HoldPoint`, `GateB_Critical(Y/N)`, `Stage_Status`, `Remarks`

##### 07_Stage_Calc
- **헤더 행**: 2
- **행/열**: 220 x 33
- **헤더** (Row 2): `Parameter`, `Value`, `Unit`, `Notes`
- **참고**: 실제 Stage 데이터 헤더는 Row 20 (Populated 버전과 동일)

##### 08_HoldPoint_Log
- **헤더 행**: 2
- **행/열**: 205 x 12
- **헤더** (Row 2, 부분): `HP_GO_CM`, `2`, `cm`, `GO if max(|Δ|) <= this`

##### 09_Evidence_Log
- **헤더 행**: 1
- **행/열**: 201 x 10
- **헤더**: `Site`, `Category`, `Document / Evidence Item`, `Req`, `Status`, `Due/Submitted`, `Portal`, `Ref No.`, `File/Link`, `Remarks`

##### 10_RACI
- **헤더 행**: 1
- **행/열**: 9 x 8
- **헤더**: `Activity / Deliverable`, `SCT Logistics`, `DSV/3PL`, `Vessel Master`, `Chief Officer/Ballast`, `Port Authority`, `HSE`, `Notes`

##### 11_Assumptions_Issues
- **헤더 행**: 1
- **행/열**: 201 x 10
- **헤더**: `ID`, `Type`, `Description`, `Value`, `Unit`, `Impact`, `Owner`, `Due`, `Status`, `Evidence/Ref`

##### 12_DataDictionary
- **헤더 행**: 1
- **행/열**: 10 x 5
- **헤더**: `Sheet`, `Field`, `Unit`, `Type`, `Definition / Rule`

**헤더 없는 시트** (5개):
- `00_README` (10 x 2)
- `Pack_A_Inputs_SSOT` (13 x 5)
- `Pack_B_Calculation_Formulas` (17 x 4)
- `Pack_D_Tide_Window_RACI` (16 x 6)

---

### 2.4 SPMT 통합 버전

#### AGI_SPMT_Shuttle_Integrated_Output.xlsx
**경로**: `spmt v1\AGI_SPMT_Shuttle_Integrated_Output.xlsx`
**시트 수**: 8개

**참고**: AGI_SPMT_Shuttle_Output.xlsx와 동일한 구조 (8개 시트, 동일한 헤더)

##### Stage_Summary
- **헤더 행**: 3
- **행/열**: 12 x 6
- **헤더**: AGI_SPMT_Shuttle_Output.xlsx와 동일

##### Stage_Loads
- **헤더 행**: 3
- **행/열**: 23 x 6
- **헤더**: AGI_SPMT_Shuttle_Output.xlsx와 동일

##### Stage_Results
- **헤더 행**: 3
- **행/열**: 12 x 8
- **헤더**: AGI_SPMT_Shuttle_Output.xlsx와 동일

##### Stage-wise Cargo on Deck
- **헤더 행**: 3
- **행/열**: 12 x 8
- **헤더**: AGI_SPMT_Shuttle_Output.xlsx와 동일

**헤더 없는 시트** (4개):
- `Cargo_SPMT_Inputs` (10 x 11)
- `Stage_Config` (37 x 4)
- `LOG` (3 x 4)
- `Sheet` (1 x 1)

#### SPMT_Integrated_Complete_NEW.xlsx
**경로**: `SPMT_Integrated_Complete_NEW.xlsx`
**시트 수**: 11개

##### 00_Cover
- **헤더 행**: None
- **행/열**: 24 x 4

##### Cargo_SPMT_Inputs
- **헤더 행**: None
- **행/열**: 11 x 10

##### LCT_Stages_Items
- **헤더 행**: 1
- **행/열**: 16 x 8
- **헤더**:
  1. `Stage`
  2. `Item`
  3. `Weight_t`
  4. `Station_m`
  5. `TCG_m`
  6. `VCG_m`
  7. `Moment_Long_t_m`
  8. `Remarks`

##### LCT_Stages_Summary
- **헤더 행**: 1
- **행/열**: 7 x 5
- **헤더**:
  1. `Stage`
  2. `Total_t`
  3. `LCG_m`
  4. `TCG_m`
  5. `VCG_m`

##### LOG
- **헤더 행**: 3
- **행/열**: 20 x 3
- **헤더**:
  1. `TS`
  2. `LEVEL`
  3. `MESSAGE`

##### Stage-wise Cargo on Deck
- **헤더 행**: 1
- **행/열**: 10 x 10
- **헤더**:
  1. `Stage`
  2. `Stage_Index`
  3. `Total_onDeck_t_calc`
  4. `LCG_x_from_midship_m_calc`
  5. `Total_onDeck_t_ssot`
  6. `LCG_x_from_midship_m_ssot`
  7. `Delta_Total_t`
  8. `Delta_LCG_x_m`
  9. `Deck_Items_Calc`
  10. `Notes`

##### Stage_Config
- **헤더 행**: None
- **행/열**: 43 x 4

##### Stage_Loads
- **헤더 행**: None
- **행/열**: 3 x 6

##### Stage_Results
- **헤더 행**: 1
- **행/열**: 10 x 10
- **헤더**: Stage-wise Cargo on Deck와 동일 (10개 컬럼)

##### Stage_Summary
- **헤더 행**: None
- **행/열**: 3 x 6

##### Submission_Stagewise
- **헤더 행**: 3
- **행/열**: 22 x 8
- **헤더**:
  1. `Stage`
  2. `Total_t`
  3. `LCG_x_midship_m`
  4. `Note`
  (나머지 4개 컬럼 확인 필요)

---

### 2.5 SPMT 관련 파일

#### AGI_SPMT_Shuttle_Output.xlsx
**경로**: `final_output_20251228_213110\AGI_SPMT_Shuttle_Output.xlsx`
**시트 수**: 8개
**데이터 소스**: 실제 추출 (2025-12-28 22:15:31)

**헤더 있는 시트** (4개):

##### Stage_Summary
- **헤더 행**: 3
- **행/열**: 12 x 6
- **헤더**:
  1. `Stage`
  2. `Stage_Name`
  3. `Total_onDeck_t`
  4. `LCG_x_from_Midship_m`
  5. `LCG_Fr_from_AP_m`
  6. `Note`

##### Stage_Loads
- **헤더 행**: 3
- **행/열**: 23 x 6
- **헤더**:
  1. `Stage`
  2. `Stage_Name`
  3. `Item`
  4. `Weight_t`
  5. `Fr_m_from_AP`
  6. `x_m_from_Midship`

##### Stage_Results
- **헤더 행**: 3
- **행/열**: 12 x 8
- **헤더**:
  1. `Stage`
  2. `Cargo Total(t) [calc]`
  3. `LCGx(m) [calc]`
  4. `Cargo Total(t) [SSOT]`
  5. `LCGx(m) [SSOT]`
  6. `ΔCargo(t)`
  7. `ΔLCGx(m)`
  8. `Note`

##### Stage-wise Cargo on Deck
- **헤더 행**: 3
- **행/열**: 12 x 8
- **헤더**: Stage_Results와 동일 (8개 컬럼)

**헤더 없는 시트** (4개):
- `Cargo_SPMT_Inputs` (10 x 11)
- `Stage_Config` (37 x 4)
- `LOG` (3 x 4)
- `Sheet` (1 x 1)

---

### 2.6 Ballast Sequence 파일

#### BALLAST_SEQUENCE.xlsx
**경로**: `final_output_20251228_213110\BALLAST_SEQUENCE.xlsx`
**시트 수**: 3개

##### Ballast_Exec
- **헤더 행**: 1
- **행/열**: 28 x 17
- **헤더**:
  1. `Stage`
  2. `Step`
  3. `Tank`
  4. `Action`
  5. `Start_t`
  6. `Target_t`
  7. `Delta_t`
  8. `Time_h`
  9. `Pump_ID`
  10. `PumpRate_tph`
  11. `Valve_Lineup`
  12. `Hold_Point`
  13. `Draft_FWD`
  14. `Draft_AFT`
  15. `Trim_cm`
  16. `UKC`
  17. `Notes`

##### Ballast_Option
- **헤더 행**: 1
- **행/열**: 42 x 7
- **헤더**:
  1. `Stage`
  2. `Tank`
  3. `Action`
  4. `Delta_t`
  5. `PumpRate_tph`
  6. `Priority`
  7. `Rationale`

##### Ballast_Sequence
- **헤더 행**: 1
- **행/열**: 28 x 19
- **헤더**: Ballast_Exec (17개) + `Valve_Sequence`, `Valve_Notes` (2개 추가)

---

### 2.7 Bryan Submission Pack

#### Bryan_Submission_Data_Pack_Populated.xlsx
**경로**: `final_output_20251228_213110\Bryan_Submission_Data_Pack_Populated.xlsx`
**시트 수**: 17개

**⚠️ 중요**: 07_Stage_Calc의 헤더 행은 2이지만, 실제 Stage 데이터 헤더는 Row 20에 위치

##### 07_Stage_Calc
- **헤더 행**: 2 (Row 2 = Parameter 테이블 헤더)
- **실제 데이터 헤더**: Row 20
- **행/열**: 220 x 35 (Populated) / 220 x 33 (Template)
- **Row 2 헤더** (Parameter 테이블, 4개):
  1. `Parameter`
  2. `Value`
  3. `Unit`
  4. `Notes`
- **Row 20 헤더** (실제 Stage 데이터, 33-35개 컬럼):
  - `Stage_ID`, `HoldPoint`, `GateB_Critical`, `Stage_Remark`, `Progress_%`, `x_stage_m`, `W_stage_t`, `Displacement_t`, `Tmean_m`, `Trim_cm`, `Draft_FWD_m`, `Draft_AFT_m`, `Freeboard_min_m`, `Tide_required_m`, `Forecast_tide_m`, `Tide_margin_m`, `UKC_min_m`, `UKC_fwd_m`, `UKC_aft_m`, `Ramp_angle_deg`, `GM_m`, `Gate_FWD`, `Gate_AFT`, `Gate_TRIM`, `Gate_UKC`, `Gate_RAMP`, `HoldPoint_Band`, `Go/No-Go`, `Ballast_Action`, `Ballast_Time_h`, `Ballast_Net_t`, `Ballast_Alloc`, `Notes`

##### 01_SSOT_Master
- **헤더 행**: 1
- **행/열**: 22 x 6
- **헤더**: `Control / Input`, `Value`, `Unit`, `Notes`, `Owner`, `Source/Ref`

##### 02_Vessel_Hydro
- **헤더 행**: 3
- **행/열**: 63 x 8
- **헤더**: `#`, `Disp_t`, `Tmean_m`, `TPC_t/cm`, `MTC_t·m/cm`, `LCF_m`, `GM_m`, `Source/Remark`

##### 03_Berth_Tide
- **헤더 행**: 3
- **행/열**: 133 x 5
- **헤더**: `Field`, `Value`, `Unit`, `Notes`, `Source`

##### 04_Cargo_SPMT
- **헤더 행**: 3
- **행/열**: 100 x 10
- **헤더**: `Item`, `Weight_t`, `CoG_x_m`, `CoG_y_m`, `CoG_z_m`, `Final_Frame`, `Ramp_Frame`, `L_m`, `W_m`, `Remarks/Source`

##### 05_Ballast_Tanks
- **헤더 행**: 1
- **행/열**: 207 x 13
- **헤더** (부분 확인): `Ballast Tank Catalog (input)`, `VENT_COEFF (t/h/mm)`, `0.86`
- **참고**: 다중 섹션 구조로 전체 헤더 확인 필요

##### 06_Stage_Plan
- **헤더 행**: 1
- **행/열**: 201 x 8
- **헤더**: `Stage_ID`, `Progress_%`, `Planned_Start`, `Planned_End`, `HoldPoint`, `GateB_Critical(Y/N)`, `Stage_Status`, `Remarks`

##### 08_HoldPoint_Log
- **헤더 행**: 2
- **행/열**: 205 x 12
- **헤더** (Row 2 기준, 부분): `HP_GO_CM`, `2`, `cm`, `GO if max(|Δ|) <= this`
- **참고**: 실제 데이터 헤더는 Row 3 이후일 가능성

##### 09_Evidence_Log
- **헤더 행**: 1
- **행/열**: 201 x 10
- **헤더**: `Site`, `Category`, `Document / Evidence Item`, `Req`, `Status`, `Due/Submitted`, `Portal`, `Ref No.`, `File/Link`, `Remarks`

##### 10_RACI
- **헤더 행**: 1
- **행/열**: 9 x 8
- **헤더**: `Activity / Deliverable`, `SCT Logistics`, `DSV/3PL`, `Vessel Master`, `Chief Officer/Ballast`, `Port Authority`, `HSE`, `Notes`

##### 11_Assumptions_Issues
- **헤더 행**: 1
- **행/열**: 201 x 10
- **헤더**: `ID`, `Type`, `Description`, `Value`, `Unit`, `Impact`, `Owner`, `Due`, `Status`, `Evidence/Ref`

##### 12_DataDictionary
- **헤더 행**: 1
- **행/열**: 10 x 5
- **헤더**: `Sheet`, `Field`, `Unit`, `Type`, `Definition / Rule`

**헤더 없는 시트** (5개):
- `00_README` (10 x 2)
- `LOG` (6 x 2)
- `Pack_A_Inputs_SSOT` (13 x 5)
- `Pack_B_Calculation_Formulas` (17 x 4)
- `Pack_D_Tide_Window_RACI` (16 x 6)

#### Bryan_Submission_Data_Pack_Template.xlsx
**경로**: `Bryan_Submission_Data_Pack_Template.xlsx`
**시트 수**: 17개
**참고**: Populated 버전과 동일한 구조 (데이터만 비어있음, 07_Stage_Calc는 33개 컬럼)

#### Bryan_Submission_Data_Pack_Populated_TIDE.xlsx
**경로**: `PIPELINE_COMPLETE_20251228_165123\final_output_20251228_202622\Bryan_Submission_Data_Pack_Populated_TIDE.xlsx`
**시트 수**: 17개
**참고**: Populated 버전과 동일한 구조 (TIDE 관련 데이터 포함)

---

### 2.8 Consolidated Excel (시간대별 버전)

#### PIPELINE_CONSOLIDATED_AGI_*.xlsx

**버전 목록** (시간순, 총 30+ 버전):
1. `PIPELINE_CONSOLIDATED_AGI_20251228_082515.xlsx`
2. `PIPELINE_CONSOLIDATED_AGI_20251228_084823.xlsx`
3. `PIPELINE_CONSOLIDATED_AGI_20251228_094702.xlsx`
4. `PIPELINE_CONSOLIDATED_AGI_20251228_104957.xlsx`
5. `PIPELINE_CONSOLIDATED_AGI_20251228_114708.xlsx`
6. `PIPELINE_CONSOLIDATED_AGI_20251228_132550.xlsx`
7. `PIPELINE_CONSOLIDATED_AGI_20251228_143611.xlsx`
8. `PIPELINE_CONSOLIDATED_AGI_20251228_145416.xlsx`
9. `PIPELINE_CONSOLIDATED_AGI_20251228_145726.xlsx`
10. `PIPELINE_CONSOLIDATED_AGI_20251228_145823.xlsx`
11. `PIPELINE_CONSOLIDATED_AGI_20251228_145908.xlsx`
12. `PIPELINE_CONSOLIDATED_AGI_20251228_151722.xlsx`
13. `PIPELINE_CONSOLIDATED_AGI_20251228_152126.xlsx`
14. `PIPELINE_CONSOLIDATED_AGI_20251228_155402.xlsx`
15. `PIPELINE_CONSOLIDATED_AGI_20251228_155655.xlsx`
16. `PIPELINE_CONSOLIDATED_AGI_20251228_160357.xlsx`
17. `PIPELINE_CONSOLIDATED_AGI_20251228_163734.xlsx`
18. `PIPELINE_CONSOLIDATED_AGI_20251228_164041.xlsx`
19. `PIPELINE_CONSOLIDATED_AGI_20251228_201732.xlsx`
20. `PIPELINE_CONSOLIDATED_AGI_20251228_201947.xlsx`
21. `PIPELINE_CONSOLIDATED_AGI_20251228_202622.xlsx`
22. `PIPELINE_CONSOLIDATED_AGI_20251228_204702.xlsx`
23. `PIPELINE_CONSOLIDATED_AGI_20251228_204957.xlsx`
24. `PIPELINE_CONSOLIDATED_AGI_20251228_205247.xlsx`
25. `PIPELINE_CONSOLIDATED_AGI_20251228_205645.xlsx`
26. `PIPELINE_CONSOLIDATED_AGI_20251228_205824.xlsx` (**29 시트**)
27. `PIPELINE_CONSOLIDATED_AGI_20251228_213110.xlsx` (**14 시트**)
28. `PIPELINE_CONSOLIDATED_AGI_20251228_213758.xlsx` (**29 시트**)

**주요 버전별 상세 시트 헤더**:

#### PIPELINE_CONSOLIDATED_AGI_20251228_213110.xlsx (14개 시트)

##### BWRB Log
- **헤더 행**: 1
- **행/열**: 60 x 14
- **헤더**: `Vessel`, `Location`, `Lat`, `Lon`, `Date`, `Start`, `End`, `Tank`, `Operation`, `Volume_m3`, `Weight_t`, `Officer`, `MasterVerified`, `Remarks`

##### BWRB_Log
- **헤더 행**: 1
- **행/열**: 60 x 11
- **헤더**: `Date/Time`, `Operation`, `Tank_ID`, `Amount_t`, `Source`, `Destination`, `FWD_Before_m`, `FWD_After_m`, `Port_Approval`, `Master_Sign`, `BWMP_Status`

##### Discharge_Matrix
- **헤더 행**: 1
- **행/열**: 60 x 8
- **헤더**: `Tank_ID`, `Capacity_t`, `LCG_m`, `Delta_FWD_per_10t_cm`, `Priority`, `Priority_Label`, `Effectiveness`, `Operational_Status`

##### Plan
- **헤더 행**: 1
- **행/열**: 60 x 35
- **헤더**: `Stage`, `Tank`, `Action`, `Weight_t`, `Start_%`, `End_%`, `Time_h`, `Draft_FWD_m_solver`, `Draft_AFT_m_solver`, `Draft_Source`, `Forecast_tide_m`, `DepthRef_m`, `UKC_min_m`, `UKC_fwd_m`, `UKC_aft_m`, `Tide_required_m`, `Tide_margin_m`, `Tide_verdict`, `Freeboard_Min_m`, `Freeboard_Min_BowStern_m`, `Freeboard_FWD_m`, `Freeboard_AFT_m`, `Gate_AFT_MIN_2p70_PASS`, `AFT_Margin_2p70_m`, `Gate_B_Applies`, `Gate_FWD_MAX_2p70_critical_only`, `FWD_Margin_2p70_m`, `Gate_Freeboard_ND`, `Freeboard_Req_ND_m`, `Freeboard_ND_Margin_m`, `D_vessel_m`, `Draft_Max_raw_m`, `Draft_Max_solver_m`, `Draft_Clipped_raw`, `Draft_Clipped_solver`

##### Sequence_Ballast_Exec
- **헤더 행**: 1
- **행/열**: 60 x 45
- **헤더**: `Stage`, `Step`, `Tank`, `Action`, `Start_t`, `Target_t`, `Delta_t`, `Time_h`, `Pump_ID`, `PumpRate_tph`, `Valve_Lineup`, `Hold_Point`, `Draft_FWD`, `Draft_AFT`, `Trim_cm`, `UKC`, `Notes`, `Draft_FWD_m_solver`, `Draft_AFT_m_solver`, `Draft_Source`, `Forecast_tide_m`, `DepthRef_m`, `UKC_min_m`, `UKC_fwd_m`, `UKC_aft_m`, `Tide_required_m`, `Tide_margin_m`, `Tide_verdict`, `Freeboard_Min_m`, `Freeboard_Min_BowStern_m`, `Freeboard_FWD_m`, `Freeboard_AFT_m`, `Gate_AFT_MIN_2p70_PASS`, `AFT_Margin_2p70_m`, `Gate_B_Applies`, `Gate_FWD_MAX_2p70_critical_only`, `FWD_Margin_2p70_m`, `Gate_Freeboard_ND`, `Freeboard_Req_ND_m`, `Freeboard_ND_Margin_m`, `D_vessel_m`, `Draft_Max_raw_m`, `Draft_Max_solver_m`, `Draft_Clipped_raw`, `Draft_Clipped_solver`

##### Sequence_Ballast_Option
- **헤더 행**: 1
- **행/열**: 60 x 35
- **헤더**: `Stage`, `Tank`, `Action`, `Delta_t`, `PumpRate_tph`, `Priority`, `Rationale`, `Draft_FWD_m_solver`, `Draft_AFT_m_solver`, `Draft_Source`, `Forecast_tide_m`, `DepthRef_m`, `UKC_min_m`, `UKC_fwd_m`, `UKC_aft_m`, `Tide_required_m`, `Tide_margin_m`, `Tide_verdict`, `Freeboard_Min_m`, `Freeboard_Min_BowStern_m`, `Freeboard_FWD_m`, `Freeboard_AFT_m`, `Gate_AFT_MIN_2p70_PASS`, `AFT_Margin_2p70_m`, `Gate_B_Applies`, `Gate_FWD_MAX_2p70_critical_only`, `FWD_Margin_2p70_m`, `Gate_Freeboard_ND`, `Freeboard_Req_ND_m`, `Freeboard_ND_Margin_m`, `D_vessel_m`, `Draft_Max_raw_m`, `Draft_Max_solver_m`, `Draft_Clipped_raw`, `Draft_Clipped_solver`

##### Sequence_Ballast_Sequence
- **헤더 행**: 1
- **행/열**: 60 x 47
- **헤더**: `Stage`, `Step`, `Tank`, `Action`, `Start_t`, `Delta_t`, `Target_t`, `Pump_ID`, `PumpRate_tph`, `Time_h`, `Valve_Lineup`, `Draft_FWD`, `Draft_AFT`, `Trim_cm`, `UKC`, `Hold_Point`, `Notes`, `Valve_Sequence`, `Valve_Notes`, `Draft_FWD_m_solver`, `Draft_AFT_m_solver`, `Draft_Source`, `Forecast_tide_m`, `DepthRef_m`, `UKC_min_m`, `UKC_fwd_m`, `UKC_aft_m`, `Tide_required_m`, `Tide_margin_m`, `Tide_verdict`, `Freeboard_Min_m`, `Freeboard_Min_BowStern_m`, `Freeboard_FWD_m`, `Freeboard_AFT_m`, `Gate_AFT_MIN_2p70_PASS`, `AFT_Margin_2p70_m`, `Gate_B_Applies`, `Gate_FWD_MAX_2p70_critical_only`, `FWD_Margin_2p70_m`, `Gate_Freeboard_ND`, `Freeboard_Req_ND_m`, `Freeboard_ND_Margin_m`, `D_vessel_m`, `Draft_Max_raw_m`, `Draft_Max_solver_m`, `Draft_Clipped_raw`, `Draft_Clipped_solver`

##### Stage_Calculations
- **헤더 행**: 1
- **행/열**: 60 x 58
- **헤더**: `Stage`, `Description`, `Mass_t`, `LCG_m`, `FWD_m`, `AFT_m`, `Trim_cm`, `Mean_m`, `Forecast_Tide_m`, `Water_Level_m`, `Max_Draft_m`, `Freeboard_Min_m`, `Gate_FWD_Max`, `Gate_AFT_Min`, `Gate_Freeboard`, `GM_m`, `GM_min_m`, `LCF_used_m`, `MCTC_used`, `TPC_used`, `FWD_Margin_m`, `AFT_Margin_m`, `Discharge_Needed_t`, `Status`, `Engineering_Grade`, `PreBallast_t`, `UKC_Min_m`, `Required_WL_m`, `Tide_required_m`, `Forecast_tide_m`, `Tide_margin_m`, `UKC_min_m`, `UKC_fwd_m`, `UKC_aft_m`, `UKC_min_actual_m`, `Gate_UKC`, `Gate_Overall`, `Draft_FWD_m_solver`, `Draft_AFT_m_solver`, `Draft_Source`, `DepthRef_m`, `Tide_verdict`, `Freeboard_Min_BowStern_m`, `Freeboard_FWD_m`, `Freeboard_AFT_m`, `Gate_AFT_MIN_2p70_PASS`, `AFT_Margin_2p70_m`, `Gate_B_Applies`, `Gate_FWD_MAX_2p70_critical_only`, `FWD_Margin_2p70_m` (나머지 8개 컬럼 확인 필요)

##### Summary
- **헤더 행**: 1
- **행/열**: 60 x 36
- **헤더**: `Stage`, `Current_FWD_m`, `Current_AFT_m`, `New_FWD_m`, `New_AFT_m`, `ΔW_t`, `PumpTime_h`, `viol_fwd_m`, `Draft_FWD_m_solver`, `Draft_AFT_m_solver`, `Draft_Source`, `Forecast_tide_m`, `DepthRef_m`, `UKC_min_m`, `UKC_fwd_m`, `UKC_aft_m`, `Tide_required_m`, `Tide_margin_m`, `Tide_verdict`, `Freeboard_Min_m`, `Freeboard_Min_BowStern_m`, `Freeboard_FWD_m`, `Freeboard_AFT_m`, `Gate_AFT_MIN_2p70_PASS`, `AFT_Margin_2p70_m`, `Gate_B_Applies`, `Gate_FWD_MAX_2p70_critical_only`, `FWD_Margin_2p70_m`, `Gate_Freeboard_ND`, `Freeboard_Req_ND_m`, `Freeboard_ND_Margin_m`, `D_vessel_m`, `Draft_Max_raw_m`, `Draft_Max_solver_m`, `Draft_Clipped_raw`, `Draft_Clipped_solver`

##### TIDE_BY_STAGE
- **헤더 행**: 1
- **행/열**: 11 x 9
- **헤더**: `Stage`, `Forecast_tide_m`, `DepthRef_m`, `UKC_min_m`, `Tide_required_m`, `Tide_margin_m`, `UKC_fwd_m`, `UKC_aft_m`, `Tide_verdict`

##### Tank Log
- **헤더 행**: 1
- **행/열**: 60 x 10
- **헤더**: `Tank`, `UseFlag`, `Mode`, `Freeze`, `x_from_mid_m`, `Start_t`, `Δt_t`, `End_t`, `Min_t`, `Max_t`

##### Tank_SSOT
- **헤더 행**: 1
- **행/열**: 60 x 11
- **헤더**: `Tank_ID`, `Category`, `Location`, `Fr_Start`, `Fr_End`, `Capacity_t`, `LCG_stern_m`, `LCG_midship_m`, `TCG_m`, `TCG_Side`, `VCG_m`

**헤더 없는 시트** (2개):
- `UKC_WL_Gate` (60 x 31)
- `VOID3_Analysis` (60 x 4)

#### PIPELINE_CONSOLIDATED_AGI_20251228_205824.xlsx (29개 시트)

**참고**: 이 버전은 TR Excel 시트들을 포함하여 29개 시트로 구성됨

**주요 시트 헤더** (상세 헤더는 위 213110 버전과 동일한 시트는 생략):

##### BWRB Log, BWRB_Log, Discharge_Matrix, Tank Log, Tank_SSOT
- 213110 버전과 동일

##### Plan
- **헤더 행**: 1
- **행/열**: 60 x 27
- **헤더**: 213110 버전의 35개 컬럼 중 27개 (확장 컬럼 일부 제외)

##### Stage_Calculations
- **헤더 행**: 1
- **행/열**: 60 x 56
- **헤더**: 213110 버전의 58개 컬럼 중 56개

##### Summary
- **헤더 행**: 1
- **행/열**: 60 x 28
- **헤더**: 213110 버전의 36개 컬럼 중 28개

##### TIDE_BY_STAGE
- **헤더 행**: 1
- **행/열**: 60 x 35
- **헤더**: `Stage`, `Forecast_tide_m`, `Forecast_Tide_m`, `DepthRef_m`, `UKC_min_m`, `UKC_Min_m`, `Tide_required_m`, `Required_WL_for_UKC_m`, `Tide_margin_m`, `UKC_fwd_m`, `UKC_FWD_m`, `UKC_aft_m`, `UKC_AFT_m`, `Tide_verification`, `Tide_note`, `Draft_FWD_m_solver`, `Draft_AFT_m_solver`, `Draft_Source`, `Freeboard_Min_m`, `Freeboard_Min_BowStern_m`, `Freeboard_FWD_m`, `Freeboard_AFT_m`, `Gate_AFT_MIN_2p70_PASS`, `AFT_Margin_2p70_m`, `Gate_B_Applies`, `Gate_FWD_MAX_2p70_critical_only`, `FWD_Margin_2p70_m`, `Gate_Freeboard_ND`, `Freeboard_Req_ND_m`, `Freeboard_ND_Margin_m`, `D_vessel_m`, `Draft_Max_raw_m`, `Draft_Max_solver_m`, `Draft_Clipped_raw`, `Draft_Clipped_solver`

**TR Excel에서 병합된 시트** (15개):

##### Ballast_Tanks
- **헤더 행**: 1
- **행/열**: 60 x 6
- **헤더**: `TankName`, `x_from_mid_m`, `max_t`, `SG`, `use_flag`, `air_vent_mm`

##### CONST_TANKS
- **헤더 행**: 3
- **행/열**: 60 x 6
- **헤더**: `Tank`, `Type`, `Weight_t`, `LCG_m`, `FSM_mt_m`, `Remarks`

##### Hydro_Table
- **헤더 행**: 1
- **행/열**: 60 x 12
- **헤더**: `Disp_t`, `Tmean_m`, `Trim_m`, `GM_m`, `Draft_FWD`, `Draft_AFT`, `LCF_m_from_midship`, `MCTC_t_m_per_cm`, `TPC_t_per_cm`, `GM_min_m`, `LCF_m`, `KM_m`

##### Frame_to_x_Table
- **헤더 행**: 1
- **행/열**: 60 x 3
- **헤더**: `Fr`, `x_from_mid_m`, `비고`

##### Hourly_FWD_AFT_Heights
- **헤더 행**: 1
- **행/열**: 745 x 14
- **헤더**: `DateTime (GST)`, `Tide_m`, `Dfwd_req_m (even)`, `Trim_m (optional)`, `Dfwd_adj_m`, `Daft_adj_m`, `Ramp_Angle_deg`, `Status`, `FWD_Height_m`, `AFT_Height_m`, `Notes`, `Trim_m (optional)` (중복)

##### MWS_Acceptance_Criteria
- **헤더 행**: 3
- **행/열**: 60 x 25
- **헤더**: `Stage`, `Available`, `PASS`, `Missing`, `Checks (key: value op limit)`, `Draft_FWD_m_solver`, `Draft_AFT_m_solver`, `Draft_Source`, `Freeboard_Min_m`, `Freeboard_Min_BowStern_m`, `Freeboard_FWD_m`, `Freeboard_AFT_m`, `Gate_AFT_MIN_2p70_PASS`, `AFT_Margin_2p70_m`, `Gate_B_Applies`, `Gate_FWD_MAX_2p70_critical_only`, `FWD_Margin_2p70_m`, `Gate_Freeboard_ND`, `Freeboard_Req_ND_m`, `Freeboard_ND_Margin_m`, `D_vessel_m`, `Draft_Max_raw_m`, `Draft_Max_solver_m`, `Draft_Clipped_raw`, `Draft_Clipped_solver`

##### MWS_Pack_Index
- **헤더 행**: 3
- **행/열**: 60 x 4
- **헤더**: `Item`, `Owner`, `Status`, `Remarks / Where to attach`

##### RORO_ISCODE_Check
- **헤더 행**: 3
- **행/열**: 60 x 30
- **헤더**: `Stage`, `Available`, `PASS`, `A0-30 (m-rad)`, `A0-40 (m-rad)`, `A30-40 (m-rad)`, `GZmax (m)`, `Ang@GZmax (deg)`, `StableRange (deg)`, `Basis/Missing`, `Draft_FWD_m_solver`, `Draft_AFT_m_solver`, `Draft_Source`, `Freeboard_Min_m`, `Freeboard_Min_BowStern_m`, `Freeboard_FWD_m`, `Freeboard_AFT_m`, `Gate_AFT_MIN_2p70_PASS`, `AFT_Margin_2p70_m`, `Gate_B_Applies`, `Gate_FWD_MAX_2p70_critical_only`, `FWD_Margin_2p70_m`, `Gate_Freeboard_ND`, `Freeboard_Req_ND_m`, `Freeboard_ND_Margin_m`, `D_vessel_m`, `Draft_Max_raw_m`, `Draft_Max_solver_m`, `Draft_Clipped_raw`, `Draft_Clipped_solver`

##### RORO_Structural_Gate
- **헤더 행**: 3
- **행/열**: 60 x 25
- **헤더**: MWS_Acceptance_Criteria와 동일

##### Calc
- **헤더 행**: 3
- **행/열**: 60 x 6
- **헤더**: (Col 1 비어있음), `SECTION`, `PARAMETER`, `UNIT`, `VALUE`, `NOTES`

**헤더 없는 시트** (9개):
- `Ballast_Scenario_Comparison` (60 x 6)
- `CSM_Trace` (60 x 5)
- `December_Tide_2025` (60 x 2)
- `OPERATION SUMMARY` (60 x 10)
- `RORO_Delta_Lever_Report` (60 x 33)
- `RORO_Draft_Margin_Check` (60 x 30)
- `RORO_Stability_Check` (60 x 1)
- `RORO_Stage_Scenarios` (60 x 74)
- `UKC_WL_Gate` (60 x 25)
- `VOID3_Analysis` (60 x 4)

**참고**: 각 버전별 시트 수와 헤더 구조는 개별 확인 필요 (버전별 차이 분석 섹션 참조)

**주요 버전별 차이**:

**확장 컬럼 패턴**:
기본 CSV 헤더에 다음 28개 컬럼이 추가됨 (Consolidated Excel 확장 버전):
1. `Draft_FWD_m_solver`
2. `Draft_AFT_m_solver`
3. `Draft_Source`
4. `Forecast_tide_m`
5. `DepthRef_m`
6. `UKC_min_m`
7. `UKC_fwd_m`
8. `UKC_aft_m`
9. `Tide_required_m`
10. `Tide_margin_m`
11. `Tide_verdict`
12. `Freeboard_Min_m`
13. `Freeboard_Min_BowStern_m`
14. `Freeboard_FWD_m`
15. `Freeboard_AFT_m`
16. `Gate_AFT_MIN_2p70_PASS`
17. `AFT_Margin_2p70_m`
18. `Gate_B_Applies`
19. `Gate_FWD_MAX_2p70_critical_only`
20. `FWD_Margin_2p70_m`
21. `Gate_Freeboard_ND`
22. `Freeboard_Req_ND_m`
23. `Freeboard_ND_Margin_m`
24. `D_vessel_m`
25. `Draft_Max_raw_m`
26. `Draft_Max_solver_m`
27. `Draft_Clipped_raw`
28. `Draft_Clipped_solver`

##### TIDE_BY_STAGE
- **기본 버전** (9개 컬럼, 213110 버전):
  1. `Stage`
  2. `Forecast_tide_m`
  3. `DepthRef_m`
  4. `UKC_min_m`
  5. `Tide_required_m`
  6. `Tide_margin_m`
  7. `UKC_fwd_m`
  8. `UKC_aft_m`
  9. `Tide_verdict`
- **확장 버전** (35개 컬럼, 205824/213758 버전):
  - 기본 9개 + 중복/별칭 컬럼 6개 (`Forecast_Tide_m`, `UKC_Min_m`, `Required_WL_for_UKC_m`, `UKC_FWD_m`, `UKC_AFT_m`, `Tide_verification`, `Tide_note`) + 확장 컬럼 20개

##### Sequence_Ballast_Exec
- **기본 버전** (17개 컬럼): BALLAST_EXEC.csv와 동일
- **확장 버전** (45개 컬럼, 213110 버전): 기본 17개 + 확장 컬럼 28개

##### Sequence_Ballast_Option
- **기본 버전** (7개 컬럼): BALLAST_OPTION.csv와 동일
- **확장 버전** (35개 컬럼, 213110 버전): 기본 7개 + 확장 컬럼 28개

##### Sequence_Ballast_Sequence
- **기본 버전** (19개 컬럼): BALLAST_SEQUENCE.csv와 동일
- **확장 버전** (47개 컬럼, 213110 버전): 기본 19개 + 확장 컬럼 28개

##### Stage_Calculations
- **OPS 버전** (37개 컬럼): OPS Excel과 동일
- **확장 버전** (56-58개 컬럼, 205824/213758 버전): 기본 37개 + 확장 컬럼 19-21개

##### Plan (Optimizer)
- **기본 버전** (7개 컬럼): optimizer_ballast_plan.xlsx와 동일
- **확장 버전** (27-35개 컬럼, Consolidated): 기본 7개 + 확장 컬럼 20-28개

##### Summary (Optimizer)
- **기본 버전** (8개 컬럼): optimizer_ballast_plan.xlsx와 동일
- **확장 버전** (28-36개 컬럼, Consolidated): 기본 8개 + 확장 컬럼 20-28개

##### Tank_SSOT
- **헤더 행**: 1
- **행/열**: 32-60 x 11
- **헤더**:
  1. `Tank_ID`
  2. `Category`
  3. `Location`
  4. `Fr_Start`
  5. `Fr_End`
  6. `Capacity_t`
  7. `LCG_stern_m`
  8. `LCG_midship_m`
  9. `TCG_m`
  10. `TCG_Side`
  11. `VCG_m`

##### Tank Log
- **헤더 행**: 1
- **행/열**: 32-60 x 10
- **헤더**: `Tank`, `UseFlag`, `Mode`, `Freeze`, `x_from_mid_m`, `Start_t`, `Δt_t`, `End_t`, `Min_t`, `Max_t`

##### BWRB Log / BWRB_Log
- **BWRB Log** (14개 컬럼): `Vessel`, `Location`, `Lat`, `Lon`, `Date`, `Start`, `End`, `Tank`, `Operation`, `Volume_m3`, `Weight_t`, `Officer`, `MasterVerified`, `Remarks`
- **BWRB_Log** (11개 컬럼): `Date/Time`, `Operation`, `Tank_ID`, `Amount_t`, `Source`, `Destination`, `FWD_Before_m`, `FWD_After_m`, `Port_Approval`, `Master_Sign`, `BWMP_Status`

##### Discharge_Matrix
- **헤더 행**: 1
- **행/열**: 5-60 x 8
- **헤더**: `Tank_ID`, `Capacity_t`, `LCG_m`, `Delta_FWD_per_10t_cm`, `Priority`, `Priority_Label`, `Effectiveness`, `Operational_Status`

**기타 시트** (TR Excel에서 병합, 205824/213758 버전에만 존재):
- `Ballast_Tanks` (60 x 6)
- `CONST_TANKS` (60 x 6)
- `Hydro_Table` (60 x 12)
- `Frame_to_x_Table` (60 x 3)
- `Hourly_FWD_AFT_Heights` (745 x 14)
- `December_Tide_2025` (60 x 2, 헤더 없음)
- `MWS_Acceptance_Criteria` (60 x 25)
- `MWS_Pack_Index` (60 x 4)
- `RORO_Delta_Lever_Report` (60 x 33, 헤더 없음)
- `RORO_Draft_Margin_Check` (60 x 30, 헤더 없음)
- `RORO_ISCODE_Check` (60 x 30)
- `RORO_Structural_Gate` (60 x 25)
- `RORO_Stage_Scenarios` (60 x 74, 헤더 없음)
- `Ballast_Scenario_Comparison` (60 x 6, 헤더 없음)
- `CSM_Trace` (60 x 5, 헤더 없음)
- `Calc` (60 x 6)
- `OPERATION SUMMARY` (60 x 10, 헤더 없음)
- `RORO_Stability_Check` (60 x 1, 헤더 없음)
- `UKC_WL_Gate` (60 x 25-31, 헤더 없음)
- `VOID3_Analysis` (60 x 4, 헤더 없음)

---

### 2.9 OPS Integrated Report

#### OPS_FINAL_R3_AGI_Ballast_Integrated.xlsx
**경로**: `OPS_FINAL_R3_AGI_Ballast_Integrated.xlsx`
**시트 수**: 6개

##### Stage_Calculations
- **헤더 행**: 1
- **행/열**: 12 x 37
- **헤더**:
  1. `Stage`
  2. `Description`
  3. `Mass_t`
  4. `LCG_m`
  5. `FWD_m`
  6. `AFT_m`
  7. `Trim_cm`
  8. `Mean_m`
  9. `Forecast_Tide_m`
  10. `Water_Level_m`
  11. `Max_Draft_m`
  12. `Freeboard_Min_m`
  13. `Gate_FWD_Max`
  14. `Gate_AFT_Min`
  15. `Gate_Freeboard`
  16. `GM_m`
  17. `GM_min_m`
  18. `LCF_used_m`
  19. `MCTC_used`
  20. `TPC_used`
  21. `FWD_Margin_m`
  22. `AFT_Margin_m`
  23. `Discharge_Needed_t`
  24. `Status`
  25. `Engineering_Grade`
  26. `PreBallast_t`
  27. `UKC_Min_m`
  28. `Required_WL_m`
  29. `Tide_required_m`
  30. `Forecast_tide_m`
  31. `Tide_margin_m`
  32. `UKC_min_m`
  33. `UKC_fwd_m`
  34. `UKC_aft_m`
  35. `UKC_min_actual_m`
  36. `Gate_UKC`
  37. `Gate_Overall`

##### Tank_SSOT
- **헤더 행**: 1
- **행/열**: 32 x 11
- **헤더**: Consolidated Excel과 동일

##### Discharge_Matrix
- **헤더 행**: 1
- **행/열**: 5 x 8
- **헤더**: Consolidated Excel과 동일

##### BWRB_Log
- **헤더 행**: 1
- **행/열**: 1 x 11
- **헤더**: Consolidated Excel BWRB_Log와 동일

**헤더 없는 시트** (2개):
- `UKC_WL_Gate` (16 x 5)
- `VOID3_Analysis` (14 x 4)

#### OPS_FINAL_R3_AGI_Ballast_Integrated_20251228_114658.xlsx
**경로**: `PIPELINE_COMPLETE_20251228_165123\final_output_20251228_114658\OPS_FINAL_R3_AGI_Ballast_Integrated_20251228_114658.xlsx`
**시트 수**: 6개
**참고**: OPS_FINAL_R3_AGI_Ballast_Integrated.xlsx와 동일한 구조

---

### 2.10 Optimizer Plan

#### optimizer_ballast_plan.xlsx
**경로**: `final_output_20251228_213110\optimizer_ballast_plan.xlsx`
**시트 수**: 4개

##### Plan
- **헤더 행**: 1
- **행/열**: 23 x 7
- **헤더**: `Stage`, `Tank`, `Action`, `Weight_t`, `Start_%`, `End_%`, `Time_h`

##### Summary
- **헤더 행**: 1
- **행/열**: 11 x 8
- **헤더**: `Stage`, `Current_FWD_m`, `Current_AFT_m`, `New_FWD_m`, `New_AFT_m`, `ΔW_t`, `PumpTime_h`, `viol_fwd_m`

##### Tank Log
- **헤더 행**: 1
- **행/열**: 32 x 10
- **헤더**: Consolidated Excel과 동일

##### BWRB Log
- **헤더 행**: 1
- **행/열**: 23 x 14
- **헤더**: Consolidated Excel BWRB Log와 동일

---

### 2.11 TR Excel

#### LCT_BUSHRA_AGI_TR_Final_v6_2.xlsx
**경로**: `final_output_20251228_213759\LCT_BUSHRA_AGI_TR_Final_v6_2.xlsx`
**시트 수**: 18개

##### Ballast_Tanks
- **헤더 행**: 1
- **행/열**: 9 x 6
- **헤더**: `TankName`, `x_from_mid_m`, `max_t`, `SG`, `use_flag`, `air_vent_mm`

##### CONST_TANKS
- **헤더 행**: 3
- **행/열**: 13 x 6
- **헤더**: `Tank`, `Type`, `Weight_t`, `LCG_m`, `FSM_mt_m`, `Remarks`

##### Hydro_Table
- **헤더 행**: 1
- **행/열**: 11 x 12
- **헤더**: `Disp_t`, `Tmean_m`, `Trim_m`, `GM_m`, `Draft_FWD`, `Draft_AFT`, `LCF_m_from_midship`, `MCTC_t_m_per_cm`, `TPC_t_per_cm`, `GM_min_m`, `LCF_m`, `KM_m`

##### Frame_to_x_Table
- **헤더 행**: 1
- **행/열**: 122 x 3
- **헤더**: `Fr`, `x_from_mid_m`, `비고`

##### Hourly_FWD_AFT_Heights
- **헤더 행**: 1
- **행/열**: 745 x 14
- **헤더**: `DateTime (GST)`, `Tide_m`, `Dfwd_req_m (even)`, `Trim_m (optional)`, `Dfwd_adj_m`, `Daft_adj_m`, `Ramp_Angle_deg`, `Status`, `FWD_Height_m`, `AFT_Height_m`, `Notes`, `Trim_m (optional)` (중복)

##### MWS_Acceptance_Criteria
- **헤더 행**: 3
- **행/열**: 13 x 5
- **헤더**: `Stage`, `Available`, `PASS`, `Missing`, `Checks (key: value op limit)`

##### MWS_Pack_Index
- **헤더 행**: 3
- **행/열**: 11 x 4
- **헤더**: `Item`, `Owner`, `Status`, `Remarks / Where to attach`

##### RORO_ISCODE_Check
- **헤더 행**: 3
- **행/열**: 13 x 10
- **헤더**: `Stage`, `Available`, `PASS`, `A0-30 (m-rad)`, `A0-40 (m-rad)`, `A30-40 (m-rad)`, `GZmax (m)`, `Ang@GZmax (deg)`, `StableRange (deg)`, `Basis/Missing`

##### RORO_Structural_Gate
- **헤더 행**: 3
- **행/열**: 13 x 5
- **헤더**: MWS_Acceptance_Criteria와 동일

##### Calc
- **헤더 행**: 3
- **행/열**: 44 x 6
- **헤더**: (Col 1 비어있음), `SECTION`, `PARAMETER`, `UNIT`, `VALUE`, `NOTES`

**헤더 없는 시트** (9개):
- `Ballast_Scenario_Comparison` (8 x 6)
- `CSM_Trace` (9 x 5)
- `December_Tide_2025` (745 x 2)
- `OPERATION SUMMARY` (20 x 10)
- `RORO_Delta_Lever_Report` (15 x 13)
- `RORO_Draft_Margin_Check` (15 x 10)
- `RORO_Stability_Check` (1 x 1)
- `RORO_Stage_Scenarios` (28 x 70)

---

## 3. Markdown 리포트 구조

[기존 내용 유지]

---

## 4. 헤더명 매핑 테이블

### 4.1 QA CSV → Bryan Pack 07_Stage_Calc 매핑

| QA CSV 컬럼 | Excel 컬럼 (Row 20) | Excel Column Index | Alias (populate_template.py) | 참고 |
|------------|---------------------|-------------------|----------------------------|------|
| `Forecast_tide_m` | `Forecast_tide_m` | Col 15 | `Forecast_Tide_m` | Row 20 헤더 |
| `UKC_fwd_m` | `UKC_fwd_m` | Col 18 | `UKC_FWD_m` | Row 20 헤더 |
| `UKC_aft_m` | `UKC_aft_m` | Col 19 | `UKC_AFT_m` | Row 20 헤더 |
| `UKC_min_m` | `UKC_min_m` | Col 17 | `UKC_Min_m`, `UKC_Min_Required_m` | Row 20 헤더 |
| `Tide_required_m` | `Tide_required_m` | Col 14 | `Required_WL_for_UKC_m` | Row 20 헤더 |
| `Tide_margin_m` | `Tide_margin_m` | Col 16 | (없음) | Row 20 헤더 |
| `Tide_verdict` | (확인 필요) | (확인 필요) | `Tide_verification` | Row 20에 없을 수 있음 |
| `DepthRef_m` | (확인 필요) | (확인 필요) | `Depth_Ref_m` | Row 20에 없을 수 있음 |

**⚠️ 중요**: `populate_template.py`는 Row 2를 헤더로 인식하지만, 실제 Stage 데이터는 Row 20부터 시작하므로 Row 20을 헤더로 인식하도록 수정 필요

### 4.2 Stage Key 매핑 (SPMT → Pipeline)

[기존 내용 유지]

### 4.3 확장 컬럼 패턴 매핑

| 기본 CSV/Excel | 확장 버전 (Consolidated) | 추가 컬럼 수 | 확장 컬럼 예시 |
|---------------|------------------------|------------|--------------|
| BALLAST_EXEC.csv (17개) | Sequence_Ballast_Exec (45개) | +28개 | Draft/Freeboard/Gate 관련 |
| BALLAST_OPTION.csv (7개) | Sequence_Ballast_Option (35개) | +28개 | Draft/Freeboard/Gate 관련 |
| BALLAST_SEQUENCE.csv (19개) | Sequence_Ballast_Sequence (47개) | +28개 | Draft/Freeboard/Gate 관련 |
| TIDE_BY_STAGE 기본 (9개) | TIDE_BY_STAGE 확장 (35개) | +26개 | 중복 컬럼 + 확장 컬럼 |
| OPS Stage_Calculations (37개) | Consolidated Stage_Calculations (56-58개) | +19-21개 | Draft/Freeboard/Gate 관련 |
| Optimizer Plan (7개) | Consolidated Plan (27-35개) | +20-28개 | Draft/Freeboard/Gate 관련 |
| Optimizer Summary (8개) | Consolidated Summary (28-36개) | +20-28개 | Draft/Freeboard/Gate 관련 |

---

## 5. 데이터 흐름 및 의존성

### 5.1 파이프라인 실행 흐름 → 출력 파일 → 헤더 구조

#### Step 0: SPMT Cargo Generation (선택적)
- **실행 파일**: `spmt v1/agi_spmt_unified.py`
- **출력 파일**: `AGI_SPMT_Shuttle_Output.xlsx`
- **생성 헤더**:
  - `Stage_Summary`: `Stage`, `Stage_Name`, `Total_onDeck_t`, `LCG_x_from_Midship_m`, `LCG_Fr_from_AP_m`, `Note`
  - `Stage_Loads`: `Stage`, `Stage_Name`, `Item`, `Weight_t`, `Fr_m_from_AP`, `x_m_from_Midship`
  - `Stage_Results`: `Stage`, `Cargo Total(t) [calc]`, `LCGx(m) [calc]`, `Cargo Total(t) [SSOT]`, `LCGx(m) [SSOT]`, `ΔCargo(t)`, `ΔLCGx(m)`, `Note`
  - `Stage-wise Cargo on Deck`: Stage_Results와 동일 (8개 컬럼)

#### Step 1: TR Excel Generation (선택적)
- **실행 파일**: `agi_tr_patched_v6_6_defsplit_v1.py`
- **출력 파일**: `LCT_BUSHRA_AGI_TR_Final_v*.xlsx`
- **생성 헤더**:
  - `Ballast_Tanks`: `TankName`, `x_from_mid_m`, `max_t`, `SG`, `use_flag`, `air_vent_mm`
  - `CONST_TANKS`: `Tank`, `Type`, `Weight_t`, `LCG_m`, `FSM_mt_m`, `Remarks`
  - `Hydro_Table`: `Disp_t`, `Tmean_m`, `Trim_m`, `GM_m`, `Draft_FWD`, `Draft_AFT`, `LCF_m_from_midship`, `MCTC_t_m_per_cm`, `TPC_t_per_cm`, `GM_min_m`, `LCF_m`, `KM_m`
  - `Hourly_FWD_AFT_Heights`: `DateTime (GST)`, `Tide_m`, `Dfwd_req_m (even)`, `Trim_m (optional)`, `Dfwd_adj_m`, `Daft_adj_m`, `Ramp_Angle_deg`, `Status`, `FWD_Height_m`, `AFT_Height_m`, `Notes`

#### Step 1b: stage_results.csv 생성 (필수)
- **실행 파일**: `agi_tr_patched_v6_6_defsplit_v1.py csv`
- **출력 파일**: `stage_results.csv`
- **생성 헤더**: `Stage`, `Dfwd_m`, `Daft_m`, `Disp_t`, `Tmean_m`, `Trim_cm` 등
- **SSOT 역할**: 이후 모든 리포트/검증 스크립트의 Stage 정의 SSOT

#### Step 2: OPS Integrated Report
- **실행 파일**: `ops_final_r3_integrated_defs_split_v4_patched_TIDE_v1.py`
- **출력 파일**: `OPS_FINAL_R3_AGI_Ballast_Integrated.xlsx`
- **생성 헤더**:
  - `Stage_Calculations`: 37개 컬럼 (Stage, Description, Mass_t, LCG_m, FWD_m, AFT_m, Trim_cm, Mean_m, Forecast_Tide_m, Water_Level_m, Max_Draft_m, Freeboard_Min_m, Gate_FWD_Max, Gate_AFT_Min, Gate_Freeboard, GM_m, GM_min_m, LCF_used_m, MCTC_used, TPC_used, FWD_Margin_m, AFT_Margin_m, Discharge_Needed_t, Status, Engineering_Grade, PreBallast_t, UKC_Min_m, Required_WL_m, Tide_required_m, Forecast_tide_m, Tide_margin_m, UKC_min_m, UKC_fwd_m, UKC_aft_m, UKC_min_actual_m, Gate_UKC, Gate_Overall)
  - `Tank_SSOT`: `Tank_ID`, `Category`, `Location`, `Fr_Start`, `Fr_End`, `Capacity_t`, `LCG_stern_m`, `LCG_midship_m`, `TCG_m`, `TCG_Side`, `VCG_m`
  - `Discharge_Matrix`: `Tank_ID`, `Capacity_t`, `LCG_m`, `Delta_FWD_per_10t_cm`, `Priority`, `Priority_Label`, `Effectiveness`, `Operational_Status`
  - `BWRB_Log`: `Date/Time`, `Operation`, `Tank_ID`, `Amount_t`, `Source`, `Destination`, `FWD_Before_m`, `FWD_After_m`, `Port_Approval`, `Master_Sign`, `BWMP_Status`

#### Step 3: Ballast Gate Solver (LP)
- **실행 파일**: `tide/ballast_gate_solver_v4_TIDE_v1.py`
- **출력 파일**:
  - `solver_ballast_plan.csv`
  - `solver_ballast_summary.csv` (TIDE_v1: 8개 Tide 컬럼)
  - `solver_ballast_stage_plan.csv`
  - `solver_state_trace.csv`
- **생성 헤더**:
  - `solver_ballast_summary.csv`: `Stage`, `Forecast_tide_m`, `DepthRef_m`, `UKC_min_m`, `Tide_required_m`, `Tide_margin_m`, `UKC_fwd_m`, `UKC_aft_m`, `Tide_verdict` (TIDE_v1 버전)
  - `solver_ballast_stage_plan.csv`: `Stage`, `Tank`, `Action`, `Delta_t`, `Target_t`, `Current_t` 등

#### Step 4: Ballast Optimizer (선택적)
- **실행 파일**: `Untitled-2_patched_defsplit_v1_1.py`
- **출력 파일**: `optimizer_ballast_plan.xlsx`
- **생성 헤더**:
  - `Plan`: `Stage`, `Tank`, `Action`, `Weight_t`, `Start_%`, `End_%`, `Time_h`
  - `Summary`: `Stage`, `Current_FWD_m`, `Current_AFT_m`, `New_FWD_m`, `New_AFT_m`, `ΔW_t`, `PumpTime_h`, `viol_fwd_m`
  - `Tank Log`: `Tank`, `UseFlag`, `Mode`, `Freeze`, `x_from_mid_m`, `Start_t`, `Δt_t`, `End_t`, `Min_t`, `Max_t`
  - `BWRB Log`: `Vessel`, `Location`, `Lat`, `Lon`, `Date`, `Start`, `End`, `Tank`, `Operation`, `Volume_m3`, `Weight_t`, `Officer`, `MasterVerified`, `Remarks`

#### Step 4b: Ballast Sequence Generator (선택적)
- **실행 파일**: `ballast_sequence_generator.py` (import 모듈)
- **출력 파일**:
  - `BALLAST_EXEC.csv` (17개 컬럼)
  - `BALLAST_OPTION.csv` (7개 컬럼)
  - `BALLAST_SEQUENCE.csv` (19개 컬럼)
  - `BALLAST_SEQUENCE.xlsx` (3개 시트: Ballast_Exec, Ballast_Option, Ballast_Sequence)
- **생성 헤더**:
  - `BALLAST_EXEC.csv`: `Stage`, `Step`, `Tank`, `Action`, `Start_t`, `Target_t`, `Delta_t`, `Time_h`, `Pump_ID`, `PumpRate_tph`, `Valve_Lineup`, `Hold_Point`, `Draft_FWD`, `Draft_AFT`, `Trim_cm`, `UKC`, `Notes`
  - `BALLAST_OPTION.csv`: `Stage`, `Tank`, `Action`, `Delta_t`, `PumpRate_tph`, `Priority`, `Rationale`
  - `BALLAST_SEQUENCE.csv`: BALLAST_EXEC (17개) + `Valve_Sequence`, `Valve_Notes` (2개 추가)

#### Step 4c: Valve Lineup Generator (선택적)
- **실행 파일**: `valve_lineup_generator.py` (import 모듈)
- **출력 파일**: `BALLAST_SEQUENCE_WITH_VALVES.md`
- **역할**: Ballast Sequence에 밸브 라인업 정보 추가

#### Step 5: Bryan Template Generation
- **실행 파일**: `tide/bryan_template_unified_TIDE_v1.py`
- **의존 스크립트**:
  - `create_bryan_excel_template_NEW.py` (subprocess)
  - `populate_template.py` (import 임베디드)
- **출력 파일**: `Bryan_Submission_Data_Pack_Populated.xlsx`
- **생성 헤더**:
  - `07_Stage_Calc`: Row 20 헤더 (33-35개 컬럼) - `Stage_ID`, `HoldPoint`, `GateB_Critical`, `Stage_Remark`, `Progress_%`, `x_stage_m`, `W_stage_t`, `Displacement_t`, `Tmean_m`, `Trim_cm`, `Draft_FWD_m`, `Draft_AFT_m`, `Freeboard_min_m`, `Tide_required_m`, `Forecast_tide_m`, `Tide_margin_m`, `UKC_min_m`, `UKC_fwd_m`, `UKC_aft_m`, `Ramp_angle_deg`, `GM_m`, `Gate_FWD`, `Gate_AFT`, `Gate_TRIM`, `Gate_UKC`, `Gate_RAMP`, `HoldPoint_Band`, `Go/No-Go`, `Ballast_Action`, `Ballast_Time_h`, `Ballast_Net_t`, `Ballast_Alloc`, `Notes`
  - `01_SSOT_Master`: `Control / Input`, `Value`, `Unit`, `Notes`, `Owner`, `Source/Ref`
  - `02_Vessel_Hydro`: `#`, `Disp_t`, `Tmean_m`, `TPC_t/cm`, `MTC_t·m/cm`, `LCF_m`, `GM_m`, `Source/Remark`
  - `03_Berth_Tide`: `Field`, `Value`, `Unit`, `Notes`, `Source`
  - `04_Cargo_SPMT`: `Item`, `Weight_t`, `CoG_x_m`, `CoG_y_m`, `CoG_z_m`, `Final_Frame`, `Ramp_Frame`, `L_m`, `W_m`, `Remarks/Source`
  - `05_Ballast_Tanks`: 다중 섹션 구조
  - `06_Stage_Plan`: `Stage_ID`, `Progress_%`, `Planned_Start`, `Planned_End`, `HoldPoint`, `GateB_Critical(Y/N)`, `Stage_Status`, `Remarks`
  - `08_HoldPoint_Log`: Row 2 헤더 (12개 컬럼)
  - `09_Evidence_Log`: `Site`, `Category`, `Document / Evidence Item`, `Req`, `Status`, `Due/Submitted`, `Portal`, `Ref No.`, `File/Link`, `Remarks`
  - `10_RACI`: `Activity / Deliverable`, `SCT Logistics`, `DSV/3PL`, `Vessel Master`, `Chief Officer/Ballast`, `Port Authority`, `HSE`, `Notes`
  - `11_Assumptions_Issues`: `ID`, `Type`, `Description`, `Value`, `Unit`, `Impact`, `Owner`, `Due`, `Status`, `Evidence/Ref`
  - `12_DataDictionary`: `Sheet`, `Field`, `Unit`, `Type`, `Definition / Rule`

#### 후처리: Excel 통합 및 최종화
- **실행 파일**:
  - `tide/excel_com_recalc_save.py` (선택적, COM 재계산)
  - `tide/ballast_excel_finalize.py` (자동 실행)
- **출력 파일**: `PIPELINE_CONSOLIDATED_AGI_*.xlsx`
- **생성 헤더**:
  - 기본 CSV 헤더 + 확장 컬럼 28개 (Draft/Freeboard/Gate 관련)
  - 버전별 차이: 14개 시트 (213110) vs 29개 시트 (205824/213758)

### 5.2 헤더 확장 패턴

**Consolidated Excel 확장 컬럼 (28개)**:
1. `Draft_FWD_m_solver`
2. `Draft_AFT_m_solver`
3. `Draft_Source`
4. `Forecast_tide_m`
5. `DepthRef_m`
6. `UKC_min_m`
7. `UKC_fwd_m`
8. `UKC_aft_m`
9. `Tide_required_m`
10. `Tide_margin_m`
11. `Tide_verdict`
12. `Freeboard_Min_m`
13. `Freeboard_Min_BowStern_m`
14. `Freeboard_FWD_m`
15. `Freeboard_AFT_m`
16. `Gate_AFT_MIN_2p70_PASS`
17. `AFT_Margin_2p70_m`
18. `Gate_B_Applies`
19. `Gate_FWD_MAX_2p70_critical_only`
20. `FWD_Margin_2p70_m`
21. `Gate_Freeboard_ND`
22. `Freeboard_Req_ND_m`
23. `Freeboard_ND_Margin_m`
24. `D_vessel_m`
25. `Draft_Max_raw_m`
26. `Draft_Max_solver_m`
27. `Draft_Clipped_raw`
28. `Draft_Clipped_solver`

**확장 패턴 적용 대상**:
- `BALLAST_EXEC.csv` (17개) → `Sequence_Ballast_Exec` (45개)
- `BALLAST_OPTION.csv` (7개) → `Sequence_Ballast_Option` (35개)
- `BALLAST_SEQUENCE.csv` (19개) → `Sequence_Ballast_Sequence` (47개)
- `TIDE_BY_STAGE` 기본 (9개) → 확장 (35개)
- `OPS Stage_Calculations` (37개) → Consolidated (56-58개)
- `Optimizer Plan` (7개) → Consolidated (27-35개)
- `Optimizer Summary` (8개) → Consolidated (28-36개)

### 5.3 SSOT 데이터 흐름

```
Step 1b (stage_results.csv)
  → Step 2 (OPS 리포트)
  → Step 3 (Solver 입력: stage_table_unified.csv)
  → Step 4 (Optimizer 입력)
  → Step 4b (Sequence Generator 입력)
  → Step 5 (Bryan Template 입력)
  → Consolidated Excel (최종 통합)
```

**SSOT 계층**:
1. **Stage 정의 SSOT**: `stage_results.csv` (Step 1b)
2. **Tank SSOT**: `tank_ssot_for_solver.csv` (Pipeline 생성)
3. **Hydro SSOT**: `hydro_ssot_for_solver.csv` (Pipeline 생성)
4. **Stage Table SSOT**: `stage_table_unified.csv` (Pipeline 생성, Tide/UKC 포함)

---

## 6. 통계 및 분석

### 6.1 파일별 시트 수 통계 (전체 추출 데이터)

| 파일 카테고리 | 파일 수 | 총 시트 수 (추정) | 평균 시트/파일 | 헤더 있는 시트 | 헤더 없는 시트 |
|-------------|---------|------------------|---------------|--------------|--------------|
| Consolidated | 30+ | 600+ | 20.0 | (확인 필요) | (확인 필요) |
| SPMT | 3 | 24 | 8.0 | 12 | 12 |
| Ballast Sequence | 1 | 3 | 3.0 | 3 | 0 |
| Bryan Pack | 4 | 60+ | 15.0 | (확인 필요) | (확인 필요) |
| OPS | 2 | 12 | 6.0 | 8 | 4 |
| Optimizer | 1 | 4 | 4.0 | 4 | 0 |
| TR Excel | 1 | 18 | 18.0 | 9 | 9 |
| QA 리포트 | 1 | 1 | 1.0 | 1 | 0 |
| 입력 파일 | 2 | 3 | 1.5 | 1 | 2 |
| **합계** | **44** | **725+** | **16.5** | **(확인 필요)** | **(확인 필요)** |

### 6.2 헤더 행 분포

| 헤더 행 | 시트 수 | 비율 | 주요 파일 |
|---------|---------|------|----------|
| 1 | 45 | 31.3% | 대부분의 기본 시트 |
| 2 | 3 | 2.1% | Bryan Pack 07_Stage_Calc, 08_HoldPoint_Log |
| 3 | 12 | 8.3% | SPMT 시트, Bryan Pack 일부, TR Excel 일부 |
| None | 84 | 58.3% | 로그, 리포트, 구조화되지 않은 데이터 |

### 6.3 컬럼 수 분포

| 컬럼 수 범위 | 시트 수 | 주요 예시 |
|------------|---------|----------|
| 1-10 | 35 | 기본 시트, 로그, SPMT Summary |
| 11-20 | 25 | Ballast Sequence, SPMT Results, Bryan Pack 일부 |
| 21-35 | 15 | Consolidated 확장 버전, Bryan Pack 07_Stage_Calc |
| 36-50 | 8 | Consolidated Stage_Calculations 확장 (37-58개) |
| 50+ | 3 | Consolidated Stage_Calculations (56-58개), RORO_Stage_Scenarios (74개) |

### 6.4 버전별 차이 분석

#### Consolidated Excel 버전별 차이

| 시트 | 213110 (14시트) | 205824/213758 (29시트) | 차이 |
|------|----------------|----------------------|------|
| TIDE_BY_STAGE | 9개 컬럼 | 35개 컬럼 | +26개 (중복 + 확장) |
| Sequence_Ballast_Exec | 45개 컬럼 | (없음) | 213110 전용 |
| Sequence_Ballast_Option | 35개 컬럼 | (없음) | 213110 전용 |
| Sequence_Ballast_Sequence | 47개 컬럼 | (없음) | 213110 전용 |
| TR Excel 시트들 | (없음) | 15개 시트 | 205824/213758 전용 |

### 6.5 Consolidated Excel 버전 진화 (신규)

**시간대별 버전 분류**:

#### 초기 버전 (08:25 - 09:47)
- `082515`, `084823`, `094702`
- **특징**: 기본 구조 형성

#### 중기 버전 (10:49 - 16:30)
- `104957`, `114708`, `132550`, `143611`, `145416`, `145726`, `145823`, `145908`, `151722`, `152126`, `155402`, `155655`, `160357`, `163734`, `164041`
- **특징**: 기능 추가 및 확장

#### 후기 버전 (20:17 - 21:37)
- `201732`, `201947`, `202622`, `204702`, `204957`, `205247`, `205645`, `205824`, `213110`, `213758`
- **특징**: 최종 통합 및 안정화

#### 버전별 시트 수 변화

| 시간대 | 버전 수 | 평균 시트 수 | 주요 변화 |
|--------|---------|-------------|----------|
| 초기 (08:25-09:47) | 3 | (확인 필요) | 기본 구조 |
| 중기 (10:49-16:30) | 15 | (확인 필요) | 기능 확장 |
| 후기 (20:17-21:37) | 10 | 14-29 | 최종 통합 |

#### 주요 버전 비교

| 버전 | 시트 수 | 특징 | 용도 |
|------|---------|------|------|
| `213110` | 14 | Sequence 시트 포함 | 최종 실행 |
| `205824` | 29 | TR Excel 시트 포함 | 최종 통합 |
| `213758` | 29 | TR Excel 시트 포함 | 최종 통합 (백업) |

---

## 7. 알려진 이슈 및 권고사항

### 7.1 즉시 조치 필요

#### 7.1.1 Bryan Pack 07_Stage_Calc 헤더 행 불일치
- **문제**: 헤더 행이 2로 표시되지만 실제 Stage 데이터 헤더는 Row 20
- **영향**: `populate_template.py`가 Row 2를 헤더로 인식하여 매핑 실패
- **증거**: 추출 데이터에서 Row 2는 `Parameter`, `Value`, `Unit`, `Notes`만 포함
- **해결**:
  1. `populate_template.py`에서 Row 20을 실제 헤더로 인식하도록 수정
  2. 또는 Excel 템플릿에서 Row 20을 헤더 행으로 명시

#### 7.1.2 Consolidated Excel 확장 컬럼 불일치
- **문제**: 버전별로 확장 컬럼 수가 다름 (9개 vs 35개, 17개 vs 45개 등)
- **영향**: 버전 간 데이터 호환성 문제, 스크립트 호환성 저하
- **해결**:
  1. 확장 컬럼 추가 로직 표준화
  2. 버전별 차이 문서화 및 마이그레이션 가이드 제공

#### 7.1.3 중복 컬럼명 (대소문자 불일치)
- **문제**: `Forecast_tide_m` vs `Forecast_Tide_m`, `UKC_min_m` vs `UKC_Min_m`
- **영향**: 헤더 매칭 실패, 데이터 불일치
- **증거**: TIDE_BY_STAGE 확장 버전에서 중복 컬럼 확인
- **해결**:
  1. 헤더 alias 매칭 로직 개선 (대소문자 변형 지원)
  2. 컬럼명 표준화 (소문자 + 언더스코어 규칙 통일)

### 7.2 중장기 개선

#### 7.2.1 헤더 없는 시트 구조화
- **문제**: 84개 시트(58.3%)가 헤더 행이 None
- **영향**: 자동화된 데이터 추출 어려움, 스크립트 호환성 저하
- **해결**:
  1. 로그/리포트 시트에 최소한의 헤더 추가
  2. 또는 구조화된 JSON/CSV 형식으로 전환

#### 7.2.2 헤더명 표준화
- **문제**: 컬럼명 네이밍 컨벤션 불일치
- **영향**: 유지보수 어려움, 오류 발생 가능성 증가
- **해결**:
  1. 컬럼명 네이밍 컨벤션 수립 (예: `snake_case`, 단위 포함)
  2. 대소문자/언더스코어 규칙 통일
  3. Data Dictionary 시트에 표준 정의

#### 7.2.3 자동화된 헤더 검증
- **목표**: CI/CD 파이프라인에 헤더 일관성 검증 추가
- **방법**:
  1. 헤더 스키마 정의 파일 생성
  2. Excel 생성 시 헤더 검증 스크립트 실행
  3. 헤더 변경 시 자동 알림

### 7.3 버전 관리 이슈 (신규)

#### 7.3.1 Consolidated Excel 버전 과다
- **문제**: 30+ 버전이 존재하여 관리 어려움
- **영향**: 어떤 버전이 최신인지 불명확, 디스크 공간 낭비
- **해결**:
  1. 버전 관리 정책 수립 (최신 3개만 유지)
  2. 자동 정리 스크립트 구현
  3. 버전별 차이 문서화

#### 7.3.2 버전별 헤더 구조 불일치
- **문제**: 시간대별로 헤더 구조가 변경됨
- **영향**: 스크립트 호환성 문제
- **해결**:
  1. 헤더 버전 관리 시스템 도입
  2. 마이그레이션 가이드 제공

---

## 8. 통계 요약

- **CSV 파일**: 10개, 총 200+ 컬럼
- **Excel 파일**: 44개 (전체 검색), 725+ 시트, 수천 개 컬럼
- **Markdown 리포트**: 5개, 50+ 주요 섹션
- **핵심 매핑 테이블**: 3개 (QA→Bryan, SPMT→Pipeline, 확장 컬럼 패턴)
- **Consolidated Excel 버전**: 30+ 개 (시간대별)
- **헤더 있는 시트**: (확인 필요)
- **헤더 없는 시트**: (확인 필요)

---

## 9. 파이프라인 실행 파일 목록

**최신 검증일**: 2025-12-29
**총 실행 파일 수**: 21개 (중복 제외, 모듈 포함)

### 9.1 필수 실행 파일 (Main Pipeline Steps)

| Step | 스크립트 파일명 | 기본 경로 | 실행 방식 | 설명 |
|------|---------------|---------|----------|------|
| **Step 0** | `agi_spmt_unified.py` | `spmt v1/agi_spmt_unified.py` | `subprocess` | SPMT cargo 입력 생성 (선택적) |
| **Step 1** | `agi_tr_patched_v6_6_defsplit_v1.py` | `agi_tr_patched_v6_6_defsplit_v1.py` | `subprocess` | TR Excel 생성 (선택적) |
| **Step 1b** | `agi_tr_patched_v6_6_defsplit_v1.py` | 동일 | `subprocess` | `stage_results.csv` 생성 (필수, csv 모드) |
| **Step 2** | `ops_final_r3_integrated_defs_split_v4_patched_TIDE_v1.py` | `ops_final_r3_integrated_defs_split_v4_patched_TIDE_v1.py` | `subprocess` | OPS Integrated 리포트 (Excel + MD) |
| **Step 3** | `ballast_gate_solver_v4_TIDE_v1.py` | `tide/ballast_gate_solver_v4_TIDE_v1.py` | `subprocess` | Ballast Gate Solver (LP) |
| **Step 4** | `Untitled-2_patched_defsplit_v1_1.py` | `Untitled-2_patched_defsplit_v1_1.py` | `subprocess` | Ballast Optimizer (선택적) |
| **Step 5** | `bryan_template_unified_TIDE_v1.py` | `tide/bryan_template_unified_TIDE_v1.py` | `subprocess` | Bryan Template 생성 및 채움 |

### 9.2 선택적 실행 파일 (Optional Steps)

| Step | 스크립트 파일명 | 기본 경로 | 실행 방식 | 활성화 조건 |
|------|---------------|---------|----------|------------|
| **Step 4b** | `ballast_sequence_generator.py` | `ballast_sequence_generator.py` | `import` (모듈) | `--enable-sequence` |
| **Step 4b** | `checklist_generator.py` | `checklist_generator.py` | `import` (모듈) | `--enable-sequence` |
| **Step 4c** | `valve_lineup_generator.py` | `valve_lineup_generator.py` | `import` (모듈) | `--enable-valve-lineup` |

### 9.3 의존 실행 파일 (Dependencies)

| 부모 스크립트 | 의존 스크립트 | 기본 경로 | 실행 방식 | 설명 |
|-------------|-------------|---------|----------|------|
| `bryan_template_unified_TIDE_v1.py` | `create_bryan_excel_template_NEW.py` | `create_bryan_excel_template_NEW.py` | `subprocess` | Bryan Template 생성 (Step 5 내부) |
| `bryan_template_unified_TIDE_v1.py` | `populate_template.py` | `populate_template.py` | `import` (임베디드) | Template 채움 로직 (Step 5 내부) |

### 9.4 후처리 실행 파일 (Post-Processing)

| 스크립트 파일명 | 기본 경로 | 실행 방식 | 활성화 조건 | 설명 |
|---------------|---------|----------|------------|------|
| `excel_com_recalc_save.py` | `tide/excel_com_recalc_save.py` | `subprocess` | `EXCEL_COM_RECALC_OUT` 환경 변수 설정 시 | Excel 수식 재계산 (COM) |
| `ballast_excel_finalize.py` | `tide/ballast_excel_finalize.py` | `subprocess` | 파일 존재 시 자동 실행 | Excel 수식 최종화 |

### 9.5 유틸리티 실행 파일 (Utilities)

| 스크립트 파일명 | 기본 경로 | 실행 방식 | 활성화 조건 | 설명 |
|---------------|---------|----------|------------|------|
| `compile_headers_registry.py` | `compile_headers_registry.py` | `import` (동적) | `HEADERS_MASTER.xlsx` 존재 시 자동 실행 | HEADERS_MASTER.xlsx → headers_registry.json 컴파일 |
| `debug_report.py` | `debug_report.py` | `import` (동적) | `--debug_report` 또는 `--auto_debug_report` | 디버그 리포트 생성 (선택적) |

### 9.6 모듈 의존성 (Module Dependencies)

| 모듈 경로 | 사용 위치 | 실행 방식 | 설명 |
|---------|---------|----------|------|
| `ssot.gates_loader` | Step 4b | `import` | `SiteProfile`, `load_agi_profile` (프로파일 로딩) |
| `ssot.data_quality_validator` | Step 3, Step 4b | `import` | `DataQualityValidator` (Tidying First Implementation) |
| `tide.tide_ukc_engine` | 여러 Step | `import` | Tide/UKC 계산 SSOT 엔진 |
| `tide.tide_constants` | 여러 Step | `import` | Tide/UKC 상수 |

### 9.7 Pre-Step 실행 파일 (선택적)

| 스크립트 파일명 | 기본 경로 | 실행 방식 | 활성화 조건 | 설명 |
|---------------|---------|----------|------------|------|
| `tide_stage_mapper.py` | `tide_stage_mapper.py` | 수동 실행 (Pre-Step) | `--tide_windows` 제공 시 | Stage별 조위 매핑 (AGI-only) |

### 9.8 실행 파일 통계

| 카테고리 | 개수 | 비고 |
|---------|------|------|
| **필수 실행 파일 (subprocess)** | 4개 | Step 1b, Step 2, Step 3 (항상 실행) |
| **선택적 실행 파일 (subprocess)** | 3개 | Step 0, Step 1, Step 4, Step 5 |
| **선택적 실행 파일 (import 모듈)** | 3개 | Step 4b, Step 4c |
| **의존 실행 파일** | 2개 | Bryan Template 내부 호출 |
| **후처리 실행 파일** | 2개 | Excel 최종화 |
| **유틸리티 실행 파일** | 2개 | Headers registry 컴파일, Debug report |
| **모듈 의존성** | 4개 | SSOT 모듈들 (import) |
| **Pre-Step 실행 파일** | 1개 | Tide mapping (수동 실행) |
| **총계** | **21개** | (중복 제외, 모듈 포함) |

### 9.9 실행 파일 → 출력 파일 → 헤더 매핑

**주요 매핑**:

| 실행 파일 | 출력 파일 | 주요 헤더 구조 |
|---------|---------|-------------|
| `agi_spmt_unified.py` | `AGI_SPMT_Shuttle_Output.xlsx` | Stage_Summary (6개), Stage_Loads (6개), Stage_Results (8개) |
| `agi_tr_patched_v6_6_defsplit_v1.py` | `LCT_BUSHRA_AGI_TR_Final_v*.xlsx` | Ballast_Tanks (6개), Hydro_Table (12개), Hourly_FWD_AFT_Heights (14개) |
| `ops_final_r3_integrated_defs_split_v4_patched_TIDE_v1.py` | `OPS_FINAL_R3_AGI_Ballast_Integrated.xlsx` | Stage_Calculations (37개), Tank_SSOT (11개) |
| `ballast_gate_solver_v4_TIDE_v1.py` | `solver_ballast_summary.csv` | 8개 Tide 컬럼 (TIDE_v1) |
| `ballast_sequence_generator.py` | `BALLAST_EXEC.csv` | 17개 컬럼 (Stage, Step, Tank, Action, Start_t, Target_t, Delta_t 등) |
| `bryan_template_unified_TIDE_v1.py` | `Bryan_Submission_Data_Pack_Populated.xlsx` | 07_Stage_Calc (Row 20, 33-35개 컬럼) |

**참고**:
- 모든 실행 파일은 `integrated_pipeline_defsplit_v2_gate270_split_v3_auditpatched_autodetect_TIDE_v1.py`에서 `step_run_script()`, `subprocess.run()`, 또는 동적 `import`로 호출됩니다.
- 스크립트 경로는 `resolve_script_path()` 함수로 자동 탐색됩니다 (`tide/` 디렉토리에서 실행해도 상위 폴더 스크립트 자동 인식).
- 상세 아키텍처는 `03_DOCUMENTATION/00_CORE_ARCHITECTURE/파이프라인 전체 아키텍처, 실행 파일, 로직 상세 설명.MD` 섹션 2.11 참조.

---

**Last Updated**: 2025-12-29
**Version**: 4.1 (전체 Excel 헤더 추출 데이터 기반 + 파이프라인 실행 파일 목록)
**Data Source**: `EXCEL_HEADERS_ALL_20251228_221902.md`
**Extraction Time**: 2025-12-28 22:18:51
**Pipeline Executables Verification**: 2025-12-29
**Search Scope**: 전체 디렉토리 (재귀 검색, ARCHIVE 제외)
**Total Files**: 44개
**Total Executable Files**: 21개
